if(window.jivo_container){var elem=document.getElementById("jivo_container");elem.parentNode.removeChild(elem);elem=document.getElementById("jivo-iframe-container");elem.parentNode.removeChild(elem);window.jivo_config&&window.jivo_config.rules&&(window.jivo_config.rules=[]);delete window.jivo_api;delete window.jivo_config;delete window.jivo_container;window.jivo_magic_var=void 0}else window.jivo_config&&(elem=document.getElementById("jivo_top_wrap"),elem.parentNode.removeChild(elem),delete window.jivo_api,
delete window.jivo_config,window.jivo_magic_var=void 0);
if("undefined"==typeof window.jivo_magic_var){var jivo_magic_var=123321;window.jivo_config={widget_id:"BEA23423424234",site_id:2517442424,widget_color:"#474747",widget_font_color:"light",widget_padding:"100",widget_height:"33",widget_orientation:"bottom",font_size:"14",font_family:"Arial",font_type:"normal",locale:"en_US",show_rate_form:0,hide_ad:1,secure:0,contacts_ask:-1,style_string:"jivo_shadow jivo_rounded_corners jivo_gradient jivo_3d_effect jivo_border jivo_3px_border",chat_mode:"offline",
options:8,hide_offline:0,online_widget_label:"Chat with us, we are online!",offline_widget_label:"Send us a message",offline_form_text:"Leave your message in the form below, and we will receive it by e-mail!",typing_insight:1,contacts_settings:{name:{show:!0,required:!1},email:{show:!0,required:!1},phone:{show:!0,required:!0}}};if("object"==typeof window.IPchatConfig&&"object"==typeof window.jivo_config)for(var property in window.IPchatConfig)window.jivo_config[property]=window.IPchatConfig[property];
var a;a="http";a+="s://";a+="cdn.";a+="sale";a+="-storm";a+=".com";a+="/wd";a+="/";a+="callhunter/chat";for(var scripts=document.getElementsByTagName("script"),src="",i=0;i<scripts.length;++i){var srctmp=scripts[i].getAttribute("src");srctmp&&0<srctmp.indexOf("/callhunter/chat/js/widget_")&&(src=srctmp)}src?(src=src.replace(/\/js\/widget\_.*$/,""),window.jivo_config.base_url=src):window.jivo_config.base_url=a}
(window.jivo_init=function(){function E(b){var c;try{c=document.getElementsByClassName(b)}catch(e){c=[];b=new RegExp("\\b"+b+"\\b");for(var d=document.getElementsByTagName("*"),f=0;f<d.length;f++)b.test(d[f].className)&&c.push(d[f])}return c}function m(){if("logs"in e){var b=Array.prototype.slice.call(arguments);if("undefined"!=typeof console&&"function"==typeof console.log)if(window.opera)for(b=0;b<arguments.length;)console.log("Item "+(b+1)+": "+arguments[b]),b++;else 1==b.length&&"string"==typeof b[0]?
console.log(b.toString()):console.log(b);else"undefined"!=typeof console&&"object"==typeof console.log&&Function.prototype.call.call(console.log,console,b)}}function ra(b,c,d){b.addEventListener?b.addEventListener(c,d,!1):b.attachEvent&&(b.attachEvent("on"+c,function(b){return function(){d.call(b,window.event)}}(b)),b=null)}function Ca(b,c,d){if(window.removeEventListener)b.removeEventListener(c,d,!1);else if(window.detachEvent)b.detachEvent("on"+c,function(){d.call(b)});else return!1}function ea(b,
c){b.readyState?(m("Using readyState callback"),b.onreadystatechange=function(){if("loaded"==b.readyState||"complete"==b.readyState)b.onreadystatechange=null,c()}):(m("Using onload callback"),b.onload=function(){"about:blank"!=b.contentWindow.location.href&&(c(),b.onload=null)})}function r(b){if("custom_langpack"in e&&b in e.custom_langpack)return e.custom_langpack[b].replace(/\n/g,"<br />").replace(/'/g,"&#039;");b=b in sa?sa[b].replace(/\n/g,"<br />"):b;return b}function k(b,c,d){"__utmz"!=b&&(b=
["jv",b,e.widget_id].join("_"));if(1<arguments.length&&"[object Object]"!==String(c)){"undefined"===typeof d&&(d={});null===c||void 0===c?(m("Clearing COOKIE "+b),d.expires=-1):m("Set COOKIE "+b+" with value "+c);if("number"===typeof d.expires){var f=d.expires,u=d.expires=new Date;u.setDate(u.getDate()+f)}c=String(c);return document.cookie=[encodeURIComponent(b),"=",encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",e.cookie_domain&&!l.isSeparateWindow()?"; domain="+e.cookie_domain:
"","; path=/"].join("")}d=c||{};u=d.raw?function(b){return b}:decodeURIComponent;return(f=(new RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)")).exec(document.cookie))?u(f[1]):null}function fa(b,c,d){}function U(b){e.disable_error_reporting?m("REPORT",b):++Da}function ga(b,c){"object"!=typeof c&&(c={});c.event=b;c.widget_id=e.widget_id;c.chat_mode=e.chat_mode;k("client_id")&&(c.client_id=k("client_id").split(".")[0])}function ta(b,c){var d={name:"cw_ping"};k("client_id")&&(d.jv_client_id=k("client_id"));
k("sess_id")&&(d.jv_sess_id=k("sess_id"));c&&(d=g.extend(d,c));fa(Y(e.widget_id,e.site_id),d,function(c){"ok"===c.result&&b(c)})}function ua(b,c){var d=0,f=c||"";g.each(g.pairs(b),function(b){10>d&&(f=f+b[0]+": "+b[1]+"; \n",d+=1)});0<d&&l.handle("gui_message",f,{implicit:1})}function I(b){return g.isArray(b)?b:b.replace(/^\s+|\s+$/g,"").split(/\s+/)}function ha(b,c){var d=c.join(" ");b.className!==d&&(b.className=d,b.offsetHeight)}function Ea(b,c,d){for(var f=["webkit","moz","MS","o",""],e=0;e<f.length;e++)f[e]||
(c=c.toLowerCase()),b.addEventListener(f[e]+c,d,!1)}function Q(b){var c=b.ownerDocument,d=c.all&&!window.opera,c=d?c.compatMode&&"BackCompat"!=c.compatMode?c.documentElement:c.body:c.defaultView||c.parentWindow,f={left:0,top:0},e;if(b.getBoundingClientRect)f=g.extend(f,b.getBoundingClientRect());else for(e=b;e;)f.left+=e.offsetLeft,f.top+=e.offsetTop,e=e.offsetParent;f.width=b.offsetWidth;f.height=b.offsetHeight;f.windowWidth=d?c.clientWidth:c.innerWidth;f.windowHeight=d?c.clientHeight:c.innerHeight;
return f}function Fa(b,c){b.style.cssText+="; top: "+c.top+"px; left : "+c.left+"px; width : "+c.width+"px; height: "+c.height+"px";return this}function Ga(){var b=!0;g.each(["name","phone","email"],function(c){e.contacts_settings[c].show&&(b=!1)},this);b&&(e.contacts_ask=2)}function Ha(){if(void 0===e.iconLocale){var b=g.find(["ru_RU","be","kk","uk"],function(b){return b===e.locale});e.iconLocale=b?b:"en"}return e.iconLocale}function Z(b,c){for(var d=(c||window.location||"").search.substring(1).split("&"),
f=0;f<d.length;f++){var e=d[f].split("=");if(e[0]==b)return decodeURIComponent(e[1])}}function z(b,c){c||(b+="?rnd=1446137274");return e.static_host?"//"+e.static_host+b:e.base_url+b}function Y(){var b=window.location.protocol+"//";"comet"in e&&(b+=e.comet.host,"https:"==window.location.protocol?"secure_port"in e.comet&&(b+=":"+e.comet.secure_port):"plain_port"in e.comet&&(b+=":"+e.comet.plain_port));return b+"/jsonp/"+g.toArray(arguments).join("/")}function ia(b){return"#"==b.charAt(0)?b.substring(1,
7):b}function ja(b){b=parseInt(b,10);if(isNaN(b))return"00";b=Math.max(0,Math.min(b,255));return"0123456789ABCDEF".charAt((b-b%16)/16)+"0123456789ABCDEF".charAt(b%16)}function V(b,c,d){var f=parseInt(ia(b).substring(0,2),16),e=parseInt(ia(b).substring(2,4),16);b=parseInt(ia(b).substring(4,6),16);f=va.toHSV(new R(f,e,b));f.v=0<f.v?f.v*c:100*(c-1);f.s*=d;c=va.toRGB(f);d=c.g;f=c.b;return"#"+(ja(c.r)+ja(d)+ja(f))}function aa(b,c,d){0>=b&&(b=0);0>=c&&(c=0);0>=d&&(d=0);360<b&&(b=360);100<c&&(c=100);100<
d&&(d=100);this.h=b;this.s=c;this.v=d}function R(b,c,d){0>=b&&(b=0);0>=c&&(c=0);0>=d&&(d=0);255<b&&(b=255);255<c&&(c=255);255<d&&(d=255);this.r=b;this.g=c;this.b=d}function ba(b,c,d,f){0>=b&&(b=0);0>=c&&(c=0);0>=d&&(d=0);0>=f&&(f=0);100<b&&(b=100);100<c&&(c=100);100<d&&(d=100);100<f&&(f=100);this.c=b;this.m=c;this.y=d;this.k=f}function Ia(){if(document.querySelector("meta[name=viewport]")){for(var b=document.querySelector("meta[name=viewport]").getAttribute("content").split(","),c=!1,d=0;d<b.length;d++){b[d]=
b[d].replace(/^\s+/,"");var f=b[d].split("=");"maximum-scale"==f[0]&&(c=!0,1<f[1]&&(f[1]="1.2"));b[d]=f[0]+"="+f[1]}c||b.push("maximum-scale=1.2");b=b.join(", ");document.querySelector("meta[name=viewport]").setAttribute("content",b)}else b=document.createElement("meta"),b.id="viewport",b.name="viewport",b.content="width=device-width, height=device-height, initial-scale=0.33, maximum-scale=1.2",document.getElementsByTagName("head")[0].appendChild(b);setInterval(function(){if(document.getElementById("jivo-label")){var b=
window.innerWidth||window.pageXOffset||document.documentElement.clientWidth||document.getElementsByTagName("html")[0],c=(b/290).toFixed(3);if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches||90===Math.abs(window.orientation))c=(b/500).toFixed(3);0!=c&&(document.getElementById("jivo-label").style.zoom=c)}},100)}var e=window.jivo_config;(function(){var b=this,c=b._,d={},f=Array.prototype,e=Object.prototype,g=f.push,n=f.slice,l=f.concat,k=e.toString,m=e.hasOwnProperty,t=f.forEach,
q=f.map,D=f.reduce,x=f.reduceRight,K=f.filter,r=f.every,v=f.some,L=f.indexOf,p=f.lastIndexOf,e=Array.isArray,y=Object.keys,h=function(b){if(b instanceof h)return b;if(!(this instanceof h))return new h(b);this._wrapped=b};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=h),exports._=h):b._=h;h.VERSION="1.4.4";var A=h.each=h.forEach=function(b,c,f){if(null!=b)if(t&&b.forEach===t)b.forEach(c,f);else if(b.length===+b.length)for(var e=0,g=b.length;e<g&&
c.call(f,b[e],e,b)!==d;e++);else for(e in b)if(h.has(b,e)&&c.call(f,b[e],e,b)===d)break};h.map=h.collect=function(b,c,d){var f=[];if(null==b)return f;if(q&&b.map===q)return b.map(c,d);A(b,function(b,w,h){f[f.length]=c.call(d,b,w,h)});return f};h.reduce=h.foldl=h.inject=function(b,c,d,f){var e=2<arguments.length;null==b&&(b=[]);if(D&&b.reduce===D)return f&&(c=h.bind(c,f)),e?b.reduce(c,d):b.reduce(c);A(b,function(b,w,h){e?d=c.call(f,d,b,w,h):(d=b,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");
return d};h.reduceRight=h.foldr=function(b,c,d,f){var e=2<arguments.length;null==b&&(b=[]);if(x&&b.reduceRight===x)return f&&(c=h.bind(c,f)),e?b.reduceRight(c,d):b.reduceRight(c);var g=b.length;if(g!==+g)var q=h.keys(b),g=q.length;A(b,function(h,n,u){n=q?q[--g]:--g;e?d=c.call(f,d,b[n],n,u):(d=b[n],e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return d};h.find=h.detect=function(b,c,d){var f;wa(b,function(b,w,e){if(c.call(d,b,w,e))return f=b,!0});return f};h.filter=
h.select=function(b,c,d){var f=[];if(null==b)return f;if(K&&b.filter===K)return b.filter(c,d);A(b,function(b,w,e){c.call(d,b,w,e)&&(f[f.length]=b)});return f};h.reject=function(b,c,d){return h.filter(b,function(b,w,f){return!c.call(d,b,w,f)},d)};h.every=h.all=function(b,c,f){c||(c=h.identity);var e=!0;if(null==b)return e;if(r&&b.every===r)return b.every(c,f);A(b,function(b,w,h){if(!(e=e&&c.call(f,b,w,h)))return d});return!!e};var wa=h.some=h.any=function(b,c,f){c||(c=h.identity);var e=!1;if(null==
b)return e;if(v&&b.some===v)return b.some(c,f);A(b,function(b,w,h){if(e||(e=c.call(f,b,w,h)))return d});return!!e};h.contains=h.include=function(b,c){return null==b?!1:L&&b.indexOf===L?-1!=b.indexOf(c):wa(b,function(b){return b===c})};h.invoke=function(b,c){var d=n.call(arguments,2),f=h.isFunction(c);return h.map(b,function(b){return(f?c:b[c]).apply(b,d)})};h.pluck=function(b,c){return h.map(b,function(b){return b[c]})};h.where=function(b,c,d){return h.isEmpty(c)?d?null:[]:h[d?"find":"filter"](b,
function(b){for(var d in c)if(c[d]!==b[d])return!1;return!0})};h.findWhere=function(b,c){return h.where(b,c,!0)};h.max=function(b,c,d){if(!c&&h.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.max.apply(Math,b);if(!c&&h.isEmpty(b))return-Infinity;var f={computed:-Infinity,value:-Infinity};A(b,function(b,w,e){w=c?c.call(d,b,w,e):b;w>=f.computed&&(f={value:b,computed:w})});return f.value};h.min=function(b,c,d){if(!c&&h.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.min.apply(Math,b);if(!c&&
h.isEmpty(b))return Infinity;var f={computed:Infinity,value:Infinity};A(b,function(b,w,e){w=c?c.call(d,b,w,e):b;w<f.computed&&(f={value:b,computed:w})});return f.value};h.shuffle=function(b){var c,d=0,f=[];A(b,function(b){c=h.random(d++);f[d-1]=f[c];f[c]=b});return f};var ka=function(b){return h.isFunction(b)?b:function(c){return c[b]}};h.sortBy=function(b,c,d){var f=ka(c);return h.pluck(h.map(b,function(b,c,w){return{value:b,index:c,criteria:f.call(d,b,c,w)}}).sort(function(b,c){var d=b.criteria,
w=c.criteria;if(d!==w){if(d>w||void 0===d)return 1;if(d<w||void 0===w)return-1}return b.index<c.index?-1:1}),"value")};var xa=function(b,c,d,f){var e={},g=ka(c||h.identity);A(b,function(c,h){var Ka=g.call(d,c,h,b);f(e,Ka,c)});return e};h.groupBy=function(b,c,d){return xa(b,c,d,function(b,c,d){(h.has(b,c)?b[c]:b[c]=[]).push(d)})};h.countBy=function(b,c,d){return xa(b,c,d,function(b,c){h.has(b,c)||(b[c]=0);b[c]++})};h.sortedIndex=function(b,c,d,f){d=null==d?h.identity:ka(d);c=d.call(f,c);for(var e=
0,g=b.length;e<g;){var q=e+g>>>1;d.call(f,b[q])<c?e=q+1:g=q}return e};h.toArray=function(b){return b?h.isArray(b)?n.call(b):b.length===+b.length?h.map(b,h.identity):h.values(b):[]};h.size=function(b){return null==b?0:b.length===+b.length?b.length:h.keys(b).length};h.first=h.head=h.take=function(b,c,d){return null==b?void 0:null==c||d?b[0]:n.call(b,0,c)};h.initial=function(b,c,d){return n.call(b,0,b.length-(null==c||d?1:c))};h.last=function(b,c,d){return null==b?void 0:null==c||d?b[b.length-1]:n.call(b,
Math.max(b.length-c,0))};h.rest=h.tail=h.drop=function(b,c,d){return n.call(b,null==c||d?1:c)};h.compact=function(b){return h.filter(b,h.identity)};var ya=function(b,c,d){A(b,function(b){h.isArray(b)?c?g.apply(d,b):ya(b,c,d):d.push(b)});return d};h.flatten=function(b,c){return ya(b,c,[])};h.without=function(b){return h.difference(b,n.call(arguments,1))};h.uniq=h.unique=function(b,c,d,f){h.isFunction(c)&&(f=d,d=c,c=!1);d=d?h.map(b,d,f):b;var e=[],g=[];A(d,function(d,f){(c?f&&g[g.length-1]===d:h.contains(g,
d))||(g.push(d),e.push(b[f]))});return e};h.union=function(){return h.uniq(l.apply(f,arguments))};h.intersection=function(b){var c=n.call(arguments,1);return h.filter(h.uniq(b),function(b){return h.every(c,function(c){return 0<=h.indexOf(c,b)})})};h.difference=function(b){var c=l.apply(f,n.call(arguments,1));return h.filter(b,function(b){return!h.contains(c,b)})};h.zip=function(){for(var b=n.call(arguments),c=h.max(h.pluck(b,"length")),d=Array(c),f=0;f<c;f++)d[f]=h.pluck(b,""+f);return d};h.object=
function(b,c){if(null==b)return{};for(var d={},f=0,e=b.length;f<e;f++)c?d[b[f]]=c[f]:d[b[f][0]]=b[f][1];return d};h.indexOf=function(b,c,d){if(null==b)return-1;var f=0,e=b.length;if(d)if("number"==typeof d)f=0>d?Math.max(0,e+d):d;else return f=h.sortedIndex(b,c),b[f]===c?f:-1;if(L&&b.indexOf===L)return b.indexOf(c,d);for(;f<e;f++)if(b[f]===c)return f;return-1};h.lastIndexOf=function(b,c,d){if(null==b)return-1;var f=null!=d;if(p&&b.lastIndexOf===p)return f?b.lastIndexOf(c,d):b.lastIndexOf(c);for(d=
f?d:b.length;d--;)if(b[d]===c)return d;return-1};h.range=function(b,c,d){1>=arguments.length&&(c=b||0,b=0);d=arguments[2]||1;for(var f=Math.max(Math.ceil((c-b)/d),0),e=0,h=Array(f);e<f;)h[e++]=b,b+=d;return h};h.bind=function(b,c){var d=n.call(arguments,2);return function(){return b.apply(c,d.concat(n.call(arguments)))}};h.partial=function(b){var c=n.call(arguments,1);return function(){return b.apply(this,c.concat(n.call(arguments)))}};h.bindAll=function(b){var c=n.call(arguments,1);0===c.length&&
(c=h.functions(b));A(c,function(c){b[c]=h.bind(b[c],b)});return b};h.memoize=function(b,c){var d={};c||(c=h.identity);return function(){var f=c.apply(this,arguments);return h.has(d,f)?d[f]:d[f]=b.apply(this,arguments)}};h.delay=function(b,c){var d=n.call(arguments,2);return setTimeout(function(){return b.apply(null,d)},c)};h.defer=function(b){return h.delay.apply(h,[b,1].concat(n.call(arguments,1)))};h.throttle=function(b,c){var d,f,e,h,g=0,q=function(){g=new Date;e=null;h=b.apply(d,f)};return function(){var n=
new Date,u=c-(n-g);d=this;f=arguments;0>=u?(clearTimeout(e),e=null,g=n,h=b.apply(d,f)):e||(e=setTimeout(q,u));return h}};h.debounce=function(b,c,d){var f,e;return function(){var h=this,g=arguments,q=d&&!f;clearTimeout(f);f=setTimeout(function(){f=null;d||(e=b.apply(h,g))},c);q&&(e=b.apply(h,g));return e}};h.once=function(b){var c=!1,d;return function(){if(c)return d;c=!0;d=b.apply(this,arguments);b=null;return d}};h.wrap=function(b,c){return function(){var d=[b];g.apply(d,arguments);return c.apply(this,
d)}};h.compose=function(){var b=arguments;return function(){for(var c=arguments,d=b.length-1;0<=d;d--)c=[b[d].apply(this,c)];return c[0]}};h.after=function(b,c){return 0>=b?c():function(){if(1>--b)return c.apply(this,arguments)}};h.keys=y||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var c=[],d;for(d in b)h.has(b,d)&&(c[c.length]=d);return c};h.values=function(b){var c=[],d;for(d in b)h.has(b,d)&&c.push(b[d]);return c};h.pairs=function(b){var c=[],d;for(d in b)h.has(b,d)&&c.push([d,
b[d]]);return c};h.invert=function(b){var c={},d;for(d in b)h.has(b,d)&&(c[b[d]]=d);return c};h.functions=h.methods=function(b){var c=[],d;for(d in b)h.isFunction(b[d])&&c.push(d);return c.sort()};h.extend=function(b){A(n.call(arguments,1),function(c){if(c)for(var d in c)b[d]=c[d]});return b};h.pick=function(b){var c={},d=l.apply(f,n.call(arguments,1));A(d,function(d){d in b&&(c[d]=b[d])});return c};h.omit=function(b){var c={},d=l.apply(f,n.call(arguments,1)),e;for(e in b)h.contains(d,e)||(c[e]=b[e]);
return c};h.defaults=function(b){A(n.call(arguments,1),function(c){if(c)for(var d in c)null==b[d]&&(b[d]=c[d])});return b};h.clone=function(b){return h.isObject(b)?h.isArray(b)?b.slice():h.extend({},b):b};h.tap=function(b,c){c(b);return b};var la=function(b,c,d,f){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof h&&(b=b._wrapped);c instanceof h&&(c=c._wrapped);var e=k.call(b);if(e!=k.call(c))return!1;switch(e){case "[object String]":return b==String(c);case "[object Number]":return b!=
+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var g=d.length;g--;)if(d[g]==b)return f[g]==c;d.push(b);f.push(c);var g=0,q=!0;if("[object Array]"==e){if(g=b.length,q=g==c.length)for(;g--&&(q=la(b[g],c[g],d,f)););}else{var e=b.constructor,n=c.constructor;if(e!==n&&!(h.isFunction(e)&&
e instanceof e&&h.isFunction(n)&&n instanceof n))return!1;for(var u in b)if(h.has(b,u)&&(g++,!(q=h.has(c,u)&&la(b[u],c[u],d,f))))break;if(q){for(u in c)if(h.has(c,u)&&!g--)break;q=!g}}d.pop();f.pop();return q};h.isEqual=function(b,c){return la(b,c,[],[])};h.isEmpty=function(b){if(null==b)return!0;if(h.isArray(b)||h.isString(b))return 0===b.length;for(var c in b)if(h.has(b,c))return!1;return!0};h.isElement=function(b){return!(!b||1!==b.nodeType)};h.isArray=e||function(b){return"[object Array]"==k.call(b)};
h.isObject=function(b){return b===Object(b)};A("Arguments Function String Number Date RegExp".split(" "),function(b){h["is"+b]=function(c){return k.call(c)=="[object "+b+"]"}});h.isArguments(arguments)||(h.isArguments=function(b){return!(!b||!h.has(b,"callee"))});"function"!==typeof/./&&(h.isFunction=function(b){return"function"===typeof b});h.isFinite=function(b){return isFinite(b)&&!isNaN(parseFloat(b))};h.isNaN=function(b){return h.isNumber(b)&&b!=+b};h.isBoolean=function(b){return!0===b||!1===
b||"[object Boolean]"==k.call(b)};h.isNull=function(b){return null===b};h.isUndefined=function(b){return void 0===b};h.has=function(b,c){return m.call(b,c)};h.noConflict=function(){b._=c;return this};h.identity=function(b){return b};h.times=function(b,c,d){for(var f=Array(b),e=0;e<b;e++)f[e]=c.call(d,e);return f};h.random=function(b,c){null==c&&(c=b,b=0);return b+Math.floor(Math.random()*(c-b+1))};var W={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};W.unescape=
h.invert(W.escape);var La={escape:new RegExp("["+h.keys(W.escape).join("")+"]","g"),unescape:new RegExp("("+h.keys(W.unescape).join("|")+")","g")};h.each(["escape","unescape"],function(b){h[b]=function(c){return null==c?"":(""+c).replace(La[b],function(c){return W[b][c]})}});h.result=function(b,c){if(null==b)return null;var d=b[c];return h.isFunction(d)?d.call(b):d};h.mixin=function(b){A(h.functions(b),function(c){var d=h[c]=b[c];h.prototype[c]=function(){var b=[this._wrapped];g.apply(b,arguments);
return ma.call(this,d.apply(h,b))}})};var Ma=0;h.uniqueId=function(b){var c=++Ma+"";return b?b+c:c};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var na=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;h.template=function(b,c,d){var f;d=h.defaults({},d,h.templateSettings);var e=new RegExp([(d.escape||na).source,(d.interpolate||na).source,(d.evaluate||na).source].join("|")+
"|$","g"),g=0,q="__p+='";b.replace(e,function(c,d,f,e,h){q+=b.slice(g,h).replace(B,function(b){return"\\"+z[b]});d&&(q+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");f&&(q+="'+\n((__t=("+f+"))==null?'':__t)+\n'");e&&(q+="';\n"+e+"\n__p+='");g=h+c.length;return c});q+="';\n";d.variable||(q="with(obj||{}){\n"+q+"}\n");q="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+q+"return __p;\n";try{f=new Function(d.variable||"obj","_",q)}catch(n){throw n.source=
q,n;}if(c)return f(c,h);c=function(b){return f.call(this,b,h)};c.source="function("+(d.variable||"obj")+"){\n"+q+"}";return c};h.chain=function(b){return h(b).chain()};var ma=function(b){return this._chain?h(b).chain():b};h.mixin(h);A("pop push reverse shift sort splice unshift".split(" "),function(b){var c=f[b];h.prototype[b]=function(){var d=this._wrapped;c.apply(d,arguments);"shift"!=b&&"splice"!=b||0!==d.length||delete d[0];return ma.call(this,d)}});A(["concat","join","slice"],function(b){var c=
f[b];h.prototype[b]=function(){return ma.call(this,c.apply(this._wrapped,arguments))}});h.extend(h.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var oa=function(b,c){var d=[].slice,f={makeFsmNamespace:function(){var b=0;return function(){return"fsm."+b++}}(),getDefaultOptions:function(){return{initialState:"uninitialized",eventListeners:{"*":[]},states:{},eventQueue:[],namespace:f.makeFsmNamespace(),targetReplayState:"",state:c,priorState:c,
_priorAction:"",_currentAction:""}}};if(!b.deepExtend){var e={"*":function(b,c,d){b[c]=d},object:function(b,c,d){b[c]=n({},b[c]||{},d)},array:function(c,d,f){c[d]=[];b.each(f,function(b,f){e[g(b)](c[d],f,b)},this)}},g=function(c){c=b.isArray(c)?"array":b.isDate(c)?"date":b.isRegExp(c)?"regex":typeof c;return e[c]?c:"*"},n=function(c){b.each(d.call(arguments,1),function(d){b.each(d,function(b,d){e[g(b)](c,d,b)})});return c};b.mixin({deepExtend:n})}var k=function(c){b.extend(this,c);b.defaults(this,
f.getDefaultOptions());this.initialize.apply(this,arguments);t.emit("newfsm",this);this.initialState&&this.transition(this.initialState)};b.extend(k.prototype,{initialize:function(){},emit:function(c){var f=arguments;this.eventListeners["*"]&&b.each(this.eventListeners["*"],function(b){try{b.apply(this,d.call(f,0))}catch(c){U(c),m(c.message)}},this);this.eventListeners[c]&&b.each(this.eventListeners[c],function(b){try{b.apply(this,d.call(f,1))}catch(c){U(c),m(c.message)}},this)},handle:function(f){if(!this.inExitHandler){var e=
this.states,g=this.state,n=d.call(arguments,0),u,k;this.currentActionArgs=n;e[g][f]||e[g]["*"]||this["*"]?(u=e[g][f]?f:"*",k="*"===u,e[g][u]?(e=e[g][u],g=g+"."+u):(e=this["*"],g="*"),this._currentAction||(this._currentAction=g),this.emit.call(this,"handling",{inputType:f,args:n.slice(1)}),b.isFunction(e)&&(e=e.apply(this,k?n:n.slice(1))),b.isString(e)&&this.transition(e),this.emit.call(this,"handled",{inputType:f,args:n.slice(1)}),this._priorAction=this._currentAction,this._currentAction="",this.processQueue("handler")):
this.emit.call(this,"nohandler",{inputType:f,args:n.slice(1)});this.currentActionArgs=c}},transition:function(b){if(!this.inExitHandler&&b!==this.state){var c;if(this.states[b]){this.targetReplayState=b;this.priorState=this.state;this.state=b;c=this.priorState;this.states[c]&&this.states[c]._onExit&&(this.inExitHandler=!0,this.states[c]._onExit.call(this),this.inExitHandler=!1);this.emit.call(this,"transition",{fromState:c,action:this._currentAction,toState:b});if(this.states[b]._onEnter)try{this.states[b]._onEnter.call(this)}catch(d){U(d),
m(d.message)}this.targetReplayState===b&&this.processQueue("transition")}else this.emit.call(this,"invalidstate",{state:this.state,attemptedState:b})}},processQueue:function(c){c=b.filter(this.eventQueue,"transition"===c?function(b){return"transition"===b.type&&(!b.untilState||b.untilState===this.state)}:function(b){return"handler"===b.type},this);this.eventQueue=b.difference(this.eventQueue,c);b.each(c,function(b){this.handle.apply(this,b.args)},this)},clearQueue:function(c,d){if(c){var f;"transition"===
c?f=function(b){return"transition"===b.type&&(d?b.untilState===d:!0)}:"handler"===c&&(f=function(b){return"handler"===b.type});this.eventQueue=b.filter(this.eventQueue,f)}else this.eventQueue=[]},deferUntilTransition:function(b){this.currentActionArgs&&(b={type:"transition",untilState:b,args:this.currentActionArgs},this.eventQueue.push(b),this.emit.call(this,"deferred",{state:this.state,queuedArgs:b}))},deferUntilNextHandler:function(){if(this.currentActionArgs){var b={type:"transition",args:this.currentActionArgs};
this.eventQueue.push(b);this.emit.call(this,"deferred",{state:this.state,queuedArgs:b})}},on:function(b,c){var d=this;d.eventListeners[b]||(d.eventListeners[b]=[]);d.eventListeners[b].push(c);return{eventName:b,callback:c,off:function(){d.off(b,c)}}},off:function(c,d){c?this.eventListeners[c]&&(this.eventListeners[c]=d?b.without(this.eventListeners[c],d):[]):this.eventListeners={}}});k.prototype.trigger=k.prototype.emit;var l=function(){},O=function(c,d,f){var e;e=d&&d.hasOwnProperty("constructor")?
d.constructor:function(){c.apply(this,arguments)};b.deepExtend(e,c);l.prototype=c.prototype;e.prototype=new l;d&&b.deepExtend(e.prototype,d);f&&b.deepExtend(e,f);e.prototype.constructor=e;e.__super__=c.prototype;return e};k.extend=function(b,c){var d=O(this,b,c);d.extend=this.extend;return d};var t={Fsm:k,utils:f,on:function(b,c){this.eventListeners[b]||(this.eventListeners[b]=[]);this.eventListeners[b].push(c);return c},off:function(c,d){this.eventListeners[c]&&(this.eventListeners[c]=b.without(this.eventListeners[c],
d))},trigger:function(c){var f=arguments,e=this.eventListeners[c]||[];e&&e.length&&b.each(e,function(b){b.apply(null,d.call(f,1))})},eventListeners:{newFsm:[]}};t.emit=t.trigger;return t}(_);(function(){var b,c,d,f;c=window.device;b={};window.device=b;f=window.navigator.userAgent.toLowerCase();b.safari=function(){return d("safari")&&!b.chrome()};b.chrome=function(){return d("chrome")};b.ios=function(){return b.iphone()||b.ipod()||b.ipad()};b.iphone=function(){return!b.windows()&&d("iphone")};b.ipod=
function(){return d("ipod")};b.ipad=function(){return d("ipad")};b.chromeIOS=function(){return d("crios")};b.android=function(){return!b.windows()&&d("android")};b.androidPhone=function(){return b.android()&&d("mobile")};b.androidTablet=function(){return b.android()&&!d("mobile")};b.blackberry=function(){return d("blackberry")||d("bb10")||d("rim")};b.blackberryPhone=function(){return b.blackberry()&&!d("tablet")};b.blackberryTablet=function(){return b.blackberry()&&d("tablet")};b.windows=function(){return d("windows")};
b.windowsPhone=function(){return b.windows()&&d("phone")};b.windowsTablet=function(){return b.windows()&&d("touch")&&!b.windowsPhone()&&!d("trident")};b.fxos=function(){return(d("(mobile;")||d("(tablet;"))&&d("; rv:")};b.fxosPhone=function(){return b.fxos()&&d("mobile")};b.fxosTablet=function(){return b.fxos()&&d("tablet")};b.meego=function(){return d("meego")};b.cordova=function(){return window.cordova&&"file:"===location.protocol};b.nodeWebkit=function(){return"object"===typeof window.process};
b.mobile=function(){return b.androidPhone()||b.iphone()||b.ipod()||b.windowsPhone()||b.blackberryPhone()||b.fxosPhone()||b.meego()};b.tablet=function(){return b.ipad()||b.androidTablet()||b.blackberryTablet()||b.windowsTablet()||b.fxosTablet()};b.desktop=function(){return!b.tablet()&&!b.mobile()};b.television=function(){var b,c="googletv viera smarttv internet.tv netcast nettv appletv boxee kylo roku dlnadoc roku pov_tv hbbtv ce-html".split(" ");for(b=0;b<c.length;){if(d(c[b]))return!0;b++}return!1};
b.portrait=function(){return 1<window.innerHeight/window.innerWidth};b.landscape=function(){return 1>window.innerHeight/window.innerWidth};b.noConflict=function(){window.device=c;return this};d=function(b){return-1!==f.indexOf(b)}}).call(this);var g=_.noConflict(),S=device.noConflict();g.templateSettings.interpolate=/\{\{(.+?)\}\}/g;var y=navigator.appVersion,ca=-1!==y.indexOf("MSIE 8."),za=-1!==y.indexOf("MSIE 9."),Na=-1!==y.indexOf("MSIE"),pa=function(){var b=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,
c=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,f=function(b,c){b=String(b);for(c=c||2;b.length<c;)b="0"+b;return b};return function(e,g,n){var k=pa;1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(g=e,e=void 0);"string"===typeof e&&isNaN(new Date(e))&&(e=e.replace(/-/g,"/").replace("T"," ").split(".").shift()+"Z");e=e?new Date(e):new Date;if(isNaN(e))throw SyntaxError("invalid date");
g=String(k.masks[g]||g||k.masks["default"]);"UTC:"==g.slice(0,4)&&(g=g.slice(4),n=!0);var l=n?"getUTC":"get",m=e[l+"Date"](),t=e[l+"Day"](),q=e[l+"Month"](),D=e[l+"FullYear"](),x=e[l+"Hours"](),r=e[l+"Minutes"](),v=e[l+"Seconds"](),l=e[l+"Milliseconds"](),p=n?0:e.getTimezoneOffset(),L={d:m,dd:f(m),ddd:k.i18n.dayNames[t],dddd:k.i18n.dayNames[t+7],m:q+1,mm:f(q+1),mmm:k.i18n.monthNames[q],mmmm:k.i18n.monthNames[q+12],yy:String(D).slice(2),yyyy:D,h:x%12||12,hh:f(x%12||12),H:x,HH:f(x),M:r,MM:f(r),s:v,
ss:f(v),l:f(l,3),L:f(99<l?Math.round(l/10):l),t:12>x?"a":"p",tt:12>x?"am":"pm",T:12>x?"A":"P",TT:12>x?"AM":"PM",Z:n?"UTC":(String(e).match(c)||[""]).pop().replace(d,""),o:(0<p?"-":"+")+f(100*Math.floor(Math.abs(p)/60)+Math.abs(p)%60,4),S:["th","st","nd","rd"][3<m%10?0:(10!=m%100-m%10)*m%10]};return g.replace(b,function(b){return b in L?L[b]:b.slice(1,b.length-1)})}}();pa.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",
shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};pa.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};var sa={b_onlineCallDefaultText:"Call us for Free!",
cw_callAfter:"Call in",cw_callButtonText:"Call back",cw_callFree:"The call is free charge. Powered by JivoChat",cw_chat:"Chat",cw_chatWithOperator:"Chat with agent",cw_close:"Close",cw_code_restrict:"Invalid direction",cw_connecting:"Connecting",cw_enterPhonePlaceholder:"Enter your phone",cw_errInfoText:"Please try to call again or contact us in the live chat",cw_formCenterText:"Did you find what you were looking for?",cw_form_second:"second",cw_form_secondd:"seconds",cw_form_seconds:"seconds",cw_pickUpPhone:"Please pick up the phone",
cw_rate_limit:"The call to the specified number is not possible",cw_repeatCall:"call again",cw_repeatCallAgain:"Call again",cw_reportPlaceholder:"Report the problem, we'll deal!",cw_reportProblem:"report a problem",cw_seconds:"seconds",cw_textSend:"send",cw_thxForCall:"Thank you for the call!",cw_typeInChat:"Chat with us",cw_unableToConnect:"The connection failed?",cw_weCalling:"We are calling you",cw_weRecallAfter:"Call back in",c_callConnected:"Call established",c_callDisconnected:"Call finished",
c_callProcessing:"Calling agent...",defCallformTitle:"Leave your number and we will call you back",defOfflineFormText:"Leave your message in the form below, and we will receive it by e-mail!",defOfflineWidgetLabel:"Send us a message",defOfflineWidgetLabelMobile:"Message",defOnlineWidgetLabel:"Chat with us, we are online!",defOnlineWidgetLabelMobile:"Chat",defRuleInvitationText:"Hello! How may I help you?",defRuleRetaining:"Please wait. All agents are busy right now, but soon someone will get free and help you!",
lblAgentDisconnected:"Agent disconnected",lblCallMe:"Call",lblCaptcha:"Type the text",lblCaptchaError:"Error, please try again",lblChatEnded:"Chat ended",lblChatIsOnline:"Agent is online",lblConnectedToAgent:"Please type your message",lblConnectionLost:"Connection lost. Reconnecting...",lblDeclineFile:"Reject",lblDefaultCobrowseComment:"Please note",lblEnterMessageHere:"Type here and hit <Enter>",lblEnterMessageOrPhoneHere:"Start chat or enter your phone number (we will call you back instantly)",
lblEvaluateCancel:"Cancel",lblEvaluatePlease:"Please rate the service quality",lblEvaluateThanks:"Thank you!",lblHangUp:"Hangup",lblHangUpShort:"Hangup",lblIntroduceButton:"Introduce",lblIntroduceName:"Your name",lblIntroduceRequest:"Please introduce yourself",lblIntroduceRequestBefore:"Introduce Yourself and Chat!",lblLeaveMessage:"Send us a message",lblLookingForFreeAgent:"Connecting...",lblMessageError:"Unfortunately message was not sent due to a technical error",lblMessageHere:"Type here",lblNegative:"Bad",
lblNewMessage:"New message!",lblNoOperators:"Unfortunately, nobody can take the chat at the moment",lblOfflineMessageSend:"Message was sent",lblOperatorsOnline:"Agents are online!",lblPencilHint:"Agent is typing a message",lblPhoneHint:"Click &quot;Allow&quot; to use microphone for the call.\r\nYour web cam will not be used",lblPositive:"Good",lblPwrBy:'Powered by <a href="https://www.ipchat.com/_URL_" target="_blank"><span class="j1">Jivo</span><span class="j2">Chat</span></a>',lblReceiveFile:"Accept",
lblReopenedElseWhere:"Chat opened in another window",lblReply:"Reply",lblSelectDep:"Select Department",lblSend:"Send",lblSendBefore:"Start Chat",lblSendingFile:"_AGENT_ is sending you file: _FILE_",lblThanks:"Thank you!",lblThankYouMessage:"Thank you for your message! We will contact you as soon as possible",lblTransferred:"Chat was transferred to agent _AGENT_",lblView:"View",lblWaitForOperator:"Please wait for an agent to answer the call...",lblWebPhoneFlashError:"Your Flash plugin version does not support web calls. Please use the chat",
lblWebPhoneMicError:"Microphone setup has failed. Please use the chat",lblWebPhoneNotAvail:"Web calls are unavailable due to connection issues. Please use the chat",lblWebPhoneNotConnected:"Call cannot be established. Please use the chat",lblYourEmail:"Your email",lblYourMessage:"Your message",lblYourPhone:"Your phone",lnkCloseThisWindow:"Close",lnkRestartChat:"Resume",ofl_enterEmail:"Please, enter e-mail",ofl_enterMessage:"Please, enter message",ofl_enterName:"Please, enter your name",ofl_enterValidEmail:"Please, enter valid email",
ofl_enterValidPhone:"Please, enter a valid phone number",seo_copyrightTextNew:'Live Chat Powered by <a href="https://www.ipchat.com/" target="_blank" id="jivosite-copyright" class="jivo-_COLOR_ jivo-en"></a>'},Da=0,Oa=(y="classList"in document.documentElement)?function(b,c){return b.classList.contains(c)}:function(b,c){return""!==b.className&&g.contains(I(b.className),c)},F=y?function(b,c){g.each(I(c),function(c){b.classList.add(c)});b.offsetHeight}:function(b,c){var d=I(b.className),d=g.union(d,
I(c));ha(b,d)},M=y?function(b,c){g.each(I(c),function(c){b.classList.remove(c)});b.offsetHeight}:function(b,c){var d=I(b.className),d=g.difference(d,I(c));ha(b,d)},qa=y?function(b,c,d){c=g.uniq(I(c));g.each(c,function(c){b.classList.toggle(c,d)});b.offsetHeight}:function(b,c,d){var f=I(b.className),e=[],l=[];g.each(I(c),function(b){var c=g.contains(f,b)?!0!==d&&l:!1!==d&&e;c&&c.push(b)});c=g.union(g.difference(f,l),e);ha(b,c)},G={fields:["client_name","phone","email"],phoneReg:/^\+?[0-9() -]+$/i,
showAd:function(){return!(e.options&8&&e.hide_ad)},hideOffline:function(){return 0<e.hide_offline&&e.options&512},isValidValue_phone:function(b){return 5<=b.replace(/\D+/g,"").length&&this.phoneReg.test(b)},isValidValue_mobilePhone:function(b){var c=b.replace(/\D+/g,""),d=-1;-1!==g.indexOf(["7","8"],c.charAt(0))?d=11:"9"===c.charAt(0)&&(d=10);return-1!==g.indexOf(["7","8","9"],c.charAt(0))&&c.length===d&&this.phoneReg.test(b)},isValidValue_email:function(b){return 4<=b.length&&/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(b)},
isValidValue_name:function(b){return 0<b.length&&100>b.length}};(function(b){if(!b.browser){b.browser={};b.browser.mozilla=!1;b.browser.webkit=!1;b.browser.opera=!1;b.browser.msie=!1;var c=navigator.userAgent;b.browser.ua=c;b.browser.name=navigator.appName;b.browser.fV=""+parseFloat(navigator.appVersion);b.browser.mV=parseInt(navigator.appVersion,10);var d,f;-1!=(f=c.indexOf("Opera"))?(b.browser.opera=!0,b.browser.name="Opera",b.browser.fV=c.substring(f+6),-1!=(f=c.indexOf("Version"))&&(b.browser.fV=
c.substring(f+8))):-1!=(f=c.indexOf("MSIE"))?(b.browser.msie=!0,b.browser.name="Microsoft Internet Explorer",b.browser.fV=c.substring(f+5)):-1!=c.indexOf("Trident")?(b.browser.msie=!0,b.browser.name="Microsoft Internet Explorer",d=c.indexOf("rv:")+3,b.browser.fV=c.substring(d,d+4)):-1!=(f=c.indexOf("Chrome"))?(b.browser.webkit=!0,b.browser.name="Chrome",b.browser.fV=c.substring(f+7)):-1!=(f=c.indexOf("Safari"))?(b.browser.webkit=!0,b.browser.name="Safari",b.browser.fV=c.substring(f+7),-1!=(f=c.indexOf("Version"))&&
(b.browser.fV=c.substring(f+8))):-1!=(f=c.indexOf("AppleWebkit"))?(b.browser.webkit=!0,b.browser.name="Safari",b.browser.fV=c.substring(f+7),-1!=(f=c.indexOf("Version"))&&(b.browser.fV=c.substring(f+8))):-1!=(f=c.indexOf("Firefox"))?(b.browser.mozilla=!0,b.browser.name="Firefox",b.browser.fV=c.substring(f+8)):(d=c.lastIndexOf(" ")+1)<(f=c.lastIndexOf("/"))&&(b.browser.name=c.substring(d,f),b.browser.fV=c.substring(f+1),b.browser.name.toLowerCase()==b.browser.name.toUpperCase()&&(b.browser.name=navigator.appName));
-1!=(c=b.browser.fV.indexOf(";"))&&(b.browser.fV=b.browser.fV.substring(0,c));-1!=(c=b.browser.fV.indexOf(" "))&&(b.browser.fV=b.browser.fV.substring(0,c));b.browser.mV=parseInt(""+b.browser.fV,10);isNaN(b.browser.mV)&&(b.browser.fV=""+parseFloat(navigator.appVersion),b.browser.mV=parseInt(navigator.appVersion,10));b.browser.version=b.browser.mV}})(G);(function(b){var c={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},d={1E3:"Normal Closure",1001:"Going away",1002:"Protocol error",1003:"Unsupported data",
1004:"reserved",1005:null,1006:null,1007:"Invalid frame payload data",1008:"Policy violation",1009:"Message Too Big",1010:"Mandatory Ext.",1011:"Internal Error",1012:"Service Restart",1013:"Try Again Later",1014:"Unassigned",1015:"TLS handshake",3001:"Attempts have Ended",3333:"Spam detected"},f=function(){},e=function(){throw Error("Not implemented");},g=function(b,c){this.name="NetworkError";this.code=c<<0;this.message=String(b)};g.prototype.toString=function(){return this.name+":"+(this.code<<
0||"")+" "+this.message};var n=function(b,c,d){if(b&&"function"===typeof b[c])try{b[c](d)}catch(f){if("onerror"===String(c))throw f;try{arguments.callee(b,"onerror",f)}catch(e){}}},l={},k;if(window&&("function"===typeof window.WebSocket||"object"===typeof window.WebSocket)){var m=window.WebSocket;k=function(b,d){var f,e=this,g;this.url=b;this.readyState=c.CONNECTING;this.close=function(b,d){if(this.readyState===c.CONNECTING)this.readyState=c.CLOSING,clearTimeout(g),g=setTimeout(function(){e.readyState=
c.CLOSED;n(e,"onclose",{wasClean:!1,code:1006,reason:""})},20);else if(this.readyState===c.OPEN){this.readyState=c.CLOSING;try{d?f.close(b,d):b?f.close(b):f.close(1E3)}catch(h){n(e,"onerror",h),n(e,"onclose",{wasClean:!1,code:1006,reason:""})}}};this.send=function(b){if(!f||f.OPEN!==f.readyState)throw Error("Socket is not open");f.send(b)};g=setTimeout(function(){try{f=d?new m(b,d):new m(b),f.onclose=function(b){clearTimeout(g);e.readyState=c.CLOSED;n(e,"onclose",b)},f.onerror=function(b){b.name||
b.message||(b.name="WebSocketError",b.message="Unknown");n(e,"onerror",b)},f.onmessage=function(b){n(e,"onmessage",b)},f.onopen=function(b){e.readyState=c.OPEN;e.protocol=f.protocol;n(e,"onopen",b)}}catch(h){n(e,"onerror",h)}},20)};for(var t in c)k.prototype[t]=c[t]}if(window&&window.navigator){if(/iP(hone|od|ad)/.test(window.navigator.platform)){var q=/OS (\d+)_(\d+)_?(\d+)?/.exec(window.navigator.appVersion);q&&6>q[1]&&(k=e)}/apple/i.test(window.navigator.vendor)&&(q=/\bVersion\/(\d+)\./.exec(window.navigator.userAgent))&&
6>q[1]&&(k=e)}l.ws=l.wss=k;var D=function(){var b=window.document.getElementsByTagName("head")[0],c,d,e,g,h=this;this.withCredentials=!1;this.readyState=0;this.responseText="";this.status=0;this.statusText="";this.timeout=void 0;var l=function(){if(c){clearTimeout(g);c.onreadystatechange=f;c.onload=f;c.onerror=f;c.parentNode.removeChild(c);e=d=c=null;h.responseText="";h.status=0;h.statusText="";h.timeout=void 0;h.withCredentials=!1;try{delete window[e]}catch(b){window[e]=void 0}n(h,"onloadend")}},
k=function(){c&&(n(h,"onerror"),l())};this.open=function(b,c){!d&&c&&(h.readyState=1,d=String(c).replace(/#.*$/,""),e="_jivo"+D._count++,d+=(-1===d.indexOf("?")?"?":"&")+"cb="+e)};this.send=function(f){d&&(f=f?"&msg="+encodeURIComponent(f):"",window[e]=function(b){h.readyState=4;D._statusBody.test(b)?(h.status=D._statusBody.exec(b)[1]<<0,h.statusText="",h.responseText="",n(h,"onerror")):(h.status=200,h.statusText="OK",h.responseText=b,n(h,"onload"));l()},c=document.createElement("script"),c.charset=
"utf-8",c.type="text/javascript",c.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(k,0)},c.readyState||(c.onload=c.onerror=k),c.src=d+f,b.appendChild(c),h.timeout<<=0,0<h.timeout&&(g=setTimeout(function(){n(h,"ontimeout");l()},h.timeout)))};this.abort=function(){n(h,"onabort");l()};this.setRequestHeader=f};D._statusBody=/^(\d{3})\n$/m;D._count=0;D.prototype={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var x=function(){if(x._stack.length)return x._stack.pop();
var b;try{b=new XMLHttpRequest,"withCredentials"in b||(b=null)}catch(c){}b=b||new D;b.release=function(){x._stack.push(b)};return b};x._stack=[];var r=function(b){for(var c,d,e,h=3E3,n=f,l=1;l<arguments.length;l++)if(arguments[l])switch(typeof arguments[l]){case "object":d=arguments[l];break;case "string":e=arguments[l];break;case "number":h=arguments[l];break;case "function":n=arguments[l]}if("string"!==typeof b)return n(TypeError("Bad URL")),null;try{c=x(),c.open(e?"POST":"GET",b,!0),e&&c.setRequestHeader("Content-Type",
"text/plain")}catch(k){return n(k),c.release(),null}h<<=0;if(0<h)try{c.timeout=h}catch(k){}c.onloadend=function(){c.release()};c.onload=function(){200===c.status?n(null,c.responseText):n(new g(c.statusText,c.status))};c.onabort=function(){n(new g("Aborted"))};c.ontimeout=function(){n(new g("Timeout"))};c.onerror=function(){n(new g("Unknown"))};if(d)for(l in d)c.setRequestHeader(l,d[l]);try{c.send(e||null)}catch(k){return n(k),c.release(),null}return function(){n=f}};b.request=r;var p=/([^\n]*)\n/gm,
e=function(b,e){/[^\/]$/.test(b)&&(b+="/");var h=this,g=f,l="open",k,q,u=2E4,m=0,t,C;this.readyState=c.CONNECTING;var J=function(b,f,e){c.CLOSED!==h.readyState&&(clearTimeout(t),h.readyState=c.CLOSED,n(h,"onclose",{wasClean:!!e,code:f||1006,reason:d[f]||b||""}))},O=function(c,d){g();g=r(b+l+(c?"/"+c:"")+"?"+(new Date).getTime(),u,d,D)},D=function(b,d){var f;if("string"!==typeof d)f=d;else{f={};var e,g;for(p.lastIndex=0;null!==(e=p.exec(d));){if(!e[1]){f.message=d.substring(e.index+1);break}e=e[1].split(/\t/);
if(g=e[0])e.shift(),f[g]=e}}switch(h.readyState){case c.CONNECTING:if(b){n(h,"onerror",b);J("Open error");break}else if(f&&f.open&&f.open[0])l=f.open[0],h.protocol=f.open[1],h.readyState=c.OPEN,n(h,"onopen");else{J("No response in state open");break}case c.OPEN:e="";if(f)f.timeout&&0<f.timeout[0]&&(u=Math.ceil(f.timeout[0])),f.etag&&f.etag[0]&&(e=f.etag[0]<<0,g=e-m,0<g&&(1!==g&&n(h,"onerror",Error("Missing "+g+" etags")),f.message&&n(h,"onmessage",{data:f.message})),m=e,e="etag/"+e),f.close&&(h.readyState=
c.CLOSING,e="close/"+(f.close[0]||"")+"/"+(f.close[1]||""));else if(b){if(204===b.status)break;n(h,"onerror",b);if(!b.status){J();break}}O(e);break;case c.CLOSING:f&&f.close?(e=f.close[0]<<0,J(f.close[1],e,!k||k===e)):J(q,k,!1)}};this.close=function(b,d){c.CONNECTING===this.readyState?(clearTimeout(C),g(),t=setTimeout(J,20)):c.OPEN===this.readyState&&(k=b<<0||1E3,q=d||"",this.readyState=c.CLOSING,O("close/"+k+"/"+q))};this.send=function(b){if(c.OPEN!==this.readyState)throw Error("Socket is not open");
if(b&&"string"===typeof b)O("send",b);else throw new TypeError("Bad data type");};var N=[];if(e)if("string"===typeof e)N.push(e);else if(e instanceof Array)for(var x=0;x<e.length;x++)N.push(String(e[x]));C=setTimeout(function(){O(N.join("/"))},20)};for(t in c)e.prototype[t]=c[t];l.http=l.https=e;var v=/^\s*(?:([^\;\/\?\:\@\&\=\+\$\,\#\n\r\s]{1,8})\:\/\/)([^\s\n\r]+)\s*$/,L=function(b,c){c||(c=[],c.index=0,c.add=function(b){c.unshift({value:String(b),health:0});c.index=0});if(b)if("string"===typeof b||
b instanceof String)c.push({value:String(b),health:0});else if(0<b.length)for(var d=0;d<b.length;d++)arguments.callee(b[d],c);return c},y=function(b,c,d){var f=b[c]=d;return function(d){arguments.length&&(f=b[c]=d);return f}},z=function(b,c){var d=1E3,f,e=function(){b&&0<=b.health&&(c(++b.health),d<<=1,f=setTimeout(e,d))};f=setTimeout(e,d);return function(){clearTimeout(f)}},h=function(){var b=0;setInterval(function(){0<b&&(b-=2,0<=b||(b=0))},1E3);return function(){return 60<++b}}(),e=function(b){var e=
L(b),g=null,n=f,k={connecting:f,open:f,close:f,error:f,message:f},q=y(this,"state",c.CLOSED),u=y(this,"url",void 0),m=y(this,"health",void 0),t=function(b,c){clearTimeout(t.value);b&&(t.value=setTimeout(b,c))},C=function(b){n();n=f;t();q(c.CLOSED);try{k.close(b)}catch(d){x(d)}u(void 0);m(void 0)},J=function(){if(h()){n();n=f;if(g){g.onclose=null;g.onerror=null;g.onmessage=null;g.onopen=null;g.close(3333);g=null;for(var b=0;b<e.lenght;b++)e[b].health=-1}return!0}return!1},O=function(b){n();n=f;t();
b||(b={wasClean:!1,code:1005,reason:"No Status Rcvd"});b.wasClean||m(--e[e.index].health);if(1012===b.code){q(c.CONNECTING);try{k.connecting(e[e.index].health)}finally{return t(K,1E4+(2E4*Math.random()<<0))}}else 1005===b.code||1E3===b.code||4E3<=b.code&&5E3>b.code?C(b):K()},x=function(b){try{k.error(b)}catch(c){throw c;}},D=function(b){try{k.message(b.data)}catch(c){x(c)}},r=function(){t();q(c.OPEN);n=z(e[e.index],m);try{k.open()}catch(b){x(b)}},p=function(){var b=e[e.index];try{var c=b.value;if("string"!==
typeof c)throw new TypeError("Bad URL type");var d=v.exec(c);if(null===d)throw Error("Bad URL");if(!l[d[1]])throw Error("Not supported URL scheme: "+d[1]);g=new l[d[1]](c)}catch(f){return b.health=-1,++e.index,x(f),K()}g.onclose=O;g.onerror=x;g.onmessage=D;g.onopen=r},K=function(b){t();if(e.index>=e.length)u(void 0),m(void 0),C({wasClean:!1,code:3001,reason:d[3001]});else if(0>e[e.index].health)x(Error("Sick URL")),++e.index,K();else{if(g){g.onclose=null;g.onerror=null;g.onmessage=null;g.onopen=null;
try{g.close()}catch(f){}}q(c.CONNECTING);var h=e[e.index];u()!==h.value&&(u(h.value),m(h.health));try{k.connecting(h.health)}catch(f){}b||0===e[e.index].health?p():t(p,1E3)}};this.open=function(b){if(J())return C({wasClean:!1,code:3333,reason:d[3333]});if(c.CONNECTING!==q()&&c.OPEN!==q()){if(b){b=String(b);for(var f=0;f<e.length;f++)if(b===e[f].value)return e.index=f,K(!0);e.add(b)}K(!0)}};this.close=function(b,f){t();c.CLOSING!==q()&&c.CLOSED!==q()&&(!g||g.CONNECTING!==g.readyState&&g.OPEN!==g.readyState?
C({wasClean:!1,code:1011,reason:d[1011]}):(b<<=0,4E3>b||5E3<=b?g.close():f?g.close(b,String(f)):g.close(b),g.onclose=C,q(c.CLOSING)))};this.send=function(b){if(c.OPEN!==q())return Error("Connection is not open");if(J())return C({wasClean:!1,code:3333,reason:d[3333]}),Error("Spam detected");try{g.send(b)}catch(f){return f}return null};var Ja=function(b,c){return function(){c.apply(b,arguments)}};this.on=function(b,c){if(b&&"object"===typeof b)for(var d in b)this.on(d,Ja(b,b[d]));else k[b]&&"function"===
typeof c&&(k[b]=c)};this.off=function(){for(var b in k)k[b]=f};this.getHealthyURLs=function(){for(var b=[],c=0;c<e.length;c++)0<=e[c].health&&b.push(e[c]);b.sort(function(b,c){return c.health-b.health});for(c=0;c<b.length;c++)b[c]=b[c].value;return b}};e.prototype={valueOf:function(){return this.toString()},toString:function(){return c.OPEN===this.state()?this.url:""},toJSON:function(b){switch(b){case "url":return'"'+this.url+'"';case "state":return this.state;case "health":return this.health}return arguments.length?
"":'{"state":'+this.state+', "health":'+this.health+', "url":"'+this.url+'"}'}};for(t in c)e.prototype[t]=c[t];b.Connection=e})(G);var va={_RGBtoHSV:function(b){var c=new aa(0,0,0),d=b.r/255,f=b.g/255;b=b.b/255;var e=Math.max(d,f,b),g=e-Math.min(d,f,b);c.v=e;if(0==g)c.h=0,c.s=0;else{c.s=g/e;var n=((e-d)/6+g/2)/g,k=((e-f)/6+g/2)/g,g=((e-b)/6+g/2)/g;d==e?c.h=g-k:f==e?c.h=1/3+n-g:b==e&&(c.h=2/3+k-n);0>c.h&&(c.h+=1);1<c.h&&--c.h}c.h=Math.round(360*c.h);c.s=Math.round(100*c.s);c.v=Math.round(100*c.v);
return c},_HSVtoRGB:function(b){var c=new R(0,0,0),d=b.h/360,e=b.s/100;b=b.v/100;if(0==e)c.r=255*b,c.g=255*b,c.b=255*b;else{var g=6*d,k=Math.floor(g),d=b*(1-e),n=b*(1-e*(g-k)),e=b*(1-e*(1-(g-k)));0==k?(k=b,g=e,b=d):1==k?(k=n,g=b,b=d):2==k?(k=d,g=b,b=e):3==k?(k=d,g=n):4==k?(k=e,g=d):(k=b,g=d,b=n);c.r=255*k;c.g=255*g;c.b=255*b;c.r=Math.round(c.r);c.g=Math.round(c.g);c.b=Math.round(c.b)}return c},_CMYKtoRGB:function(b){var c=new R(0,0,0),d=b.m/100,e=b.y/100,g=b.k/100;c.r=1-Math.min(1,b.c/100*(1-g)+g);
c.g=1-Math.min(1,d*(1-g)+g);c.b=1-Math.min(1,e*(1-g)+g);c.r=Math.round(255*c.r);c.g=Math.round(255*c.g);c.b=Math.round(255*c.b);return c},_RGBtoCMYK:function(b){var c=new ba(0,0,0,0),d=b.r/255,e=b.g/255;b=b.b/255;c.k=Math.min(1-d,1-e,1-b);c.c=(1-d-c.k)/(1-c.k);c.m=(1-e-c.k)/(1-c.k);c.y=(1-b-c.k)/(1-c.k);c.c=Math.round(100*c.c);c.m=Math.round(100*c.m);c.y=Math.round(100*c.y);c.k=Math.round(100*c.k);return c},toRGB:function(b){if(b instanceof R)return b;if(b instanceof aa)return this._HSVtoRGB(b);if(b instanceof
ba)return this._CMYKtoRGB(b)},toHSV:function(b){if(b instanceof aa)return b;if(b instanceof R)return this._RGBtoHSV(b);if(b instanceof ba)return this._RGBtoHSV(this._CMYKtoRGB(b))},toCMYK:function(b){if(b instanceof ba)return b;if(b instanceof R)return this._RGBtoCMYK(b);if(b instanceof aa)return this._RGBtoCMYK(this._HSVtoRGB(b))}};oa.on("newfsm",function(b){b.on("handling",function(b){m(this.namespace+": handling "+b.inputType+" in state "+this.state)});b.on("nohandler",function(b){m(this.namespace+
": unhandled "+b.inputType+" in state "+this.state)});b.on("transition",function(b){m([this.namespace+":","transition from:",b.fromState,"to:",b.toState,"action:",b.action].join(" "))})});var y=oa.Fsm.extend({_fireEvent:function(b){delete this._scheduled_events[b];this.handle(b)},_scheduleEvent:function(b,c){b in this._scheduled_events?m(this.namespace+": attempt to re-schedule event"+b):(m(this.namespace+": scheduling "+b+" for "+c),this._scheduled_events[b]=setTimeout(g.bind(this._fireEvent,this,
b),c))},_cancelEvent:function(b){b in this._scheduled_events?(clearTimeout(this._scheduled_events[b]),delete this._scheduled_events[b]):m(this.namespace+": attempt to cancel not scheduled event",b)},constructor:function(){this._scheduled_events={};oa.Fsm.apply(this,arguments)}}),Pa={inited:!1,initialize:function(){this.inited||(this.initScroll(),this.initClose(),this.inited=!0)},initScroll:function(){window.onscroll=g.throttle(g.bind(this._scroll,this),150)},initClose:function(){this.last_position=
{};window.onmousemove=g.throttle(g.bind(this._mouse,this),150)},_mouse:function(b){if("undefined"!==typeof this.last_position.x){var c=this.last_position.x-b.clientX,d=this.last_position.y-b.clientY;Math.abs(c)>Math.abs(d)&&0<c||Math.abs(c)>Math.abs(d)&&0>c||Math.abs(d)>Math.abs(c)&&0<d&&30>b.clientY&&l.handle("move_close_button")}this.last_position={x:b.clientX,y:b.clientY}},_scroll:function(b){l.handle("move_scroll",Math.round((document.documentElement.scrollTop+document.body.scrollTop)/(document.documentElement.scrollHeight-
document.documentElement.clientHeight)*100))}},Qa=y.extend({initialize:function(){this.namespace="RULE#"+this.name.replace(" ","_");this.initialState="unreachable";var b=[],c=!1,d;if(!k(this.commands[0].command+"_onceADay")){for(;d=this.conditions.pop();)if(this.isGoalCondition(d)&&Pa.initialize(),this.isTimeCondition(d)||this.isGoalCondition(d))b.push(d);else{if("page_url"===d.condition)d.value=d.value.replace("http://","").replace("https://","");else if("ab_test_group"==d.condition&&!k("ab_test_group")){var e=
Math.round(Math.random()),g=d.group_name?d.group_name:"JivoSite A/B Group";k("ab_test_group",e?"group_a":"group_b");B.setABTestGroupContacts(g,e?"Group A":"Group B")}if(this.checkCondition(d))c=!0;else if("all"===this.type)return}0<b.length?(this.conditions=b,this.checkTimeConditions()?this.initialState="triggered":this.initialState="time_wait"):c&&(this.initialState="triggered")}},checkTimeConditions:function(){for(var b=!1,c=0;c<this.conditions.length;c++)if(this.checkCondition(this.conditions[c]))b=
!0;else if("all"===this.type)return!1;return b},isTimeCondition:function(b){return 0<=b.condition.indexOf("time")},isGoalCondition:function(b){return"goal_close"==b.condition||"goal_scroll"==b.condition},checkCondition:function(b){var c=this.getValue(b.condition),d=this.compare(c,b.value,b.comparator);d||m(this.namespace+": failed condition "+b.condition+"; expected="+b.value+"; actual="+c);return d},getValue:function(b){switch(b){case "online":return"online"===e.chat_mode;case "page_url":return window.location.href.replace("http://",
"").replace("https://","");case "hour":return(new Date).getHours();case "page_title":return document.title;case "week_day":return(new Date).getDay();case "time_after_close":return b=k("close_time"),null===b?Number.MAX_VALUE:this.timeDiff(b);case "time_after_first_message":return null!==H.firstMessageTime?this.timeDiff(H.firstMessageTime.getTime()):NaN;case "time_after_invitation":return b=k("invitation_time"),null===b||""===b?Number.MAX_VALUE:this.timeDiff(b);case "time_on_page":return this.timeDiff(H.pageEnterTime);
case "time_on_site":return this.timeDiff(k("enter_ts"));case "number_of_visits":return k("visits_count");case "goal_close":return H.movedToCloseButton;case "goal_scroll":return H.scrollPosition;default:return k(b)}},timeDiff:function(b){return Math.round(((new Date).getTime()-b)/1E3)},compare:function(b,c,d){switch(d){case "contain":return-1!=b.toLowerCase().indexOf(c.toLowerCase());case "greater":return b>c;case "greater_equal":return b>=c;case "lower":return b<c;case "lower_equal":return b<=c;case "not_contain":return-1===
b.toLowerCase().indexOf(c.toLowerCase());case "not_equal":return c!=b;case "regexp":return(new RegExp(b,"i")).test(c);default:return c===b}},states:{time_wait:{_onEnter:function(){this._scheduleEvent("tick",1E3)},tick:function(){this.checkTimeConditions()?this.transition("triggered"):this._scheduleEvent("tick",1E3)},cancel:"unreachable"},unreachable:{},triggered:{_onEnter:function(){var b=this.commands[0],c;"object"===typeof b.params&&b.params.onceADay&&(c=b.command+"_onceADay");if(-1!==g.indexOf(["uninitialized",
"WIDGET"],l.gui.state)||-1===g.indexOf(["proactive","open_offline","show_callform"],b.command))switch(b.command){case "proactive":H.showProactive(b.params.message,b.params.department,this.name,c);break;case "open_offline":if("online"===e.chat_mode)break;k("invitation_time",(new Date).getTime());c&&H.addOnceADayCookie(c);b.params&&(b.params.title&&(e.offline_form_title=b.params.title),b.params.message&&(e.offline_form_text=b.params.message));setTimeout(function(){l.isMobileOrTablet()?l.gui.incrementCounter():
(l.handle("gui_maximize"),l.soundPlayer.incomingMessage())},0);break;case "hide":l.handle("hide");break;case "system_message":l.handle("system_message",{message:b.params.message});break;case "show_callform":m(this.namespace+"rule triggered: show_callform",b),H.showCallForm(b.params.title,c)}}}}}),H=new y({initialState:!1,isInited:!1,namespace:"ruleManager",scrollPosition:!1,movedToCloseButton:!1,init:function(){m("RULE MANAGER READY");this.rules=[];g.defaults(e,{rules:[]});this.pageEnterTime=(new Date).getTime();
k("pages_count")?k("pages_count",parseInt(k("pages_count"))+1):k("pages_count",1);l.on("handling",g.bind(this.onJivoHandling,this));0==e.rules.length&&g.isArray(e.proactive_rules)&&0<e.proactive_rules.length?(this.importLegacy(),this.transition("ready")):this.needGeo()?this.transition("fetch_geo"):(this.isInited=!0,this.transition("ready"))},needGeo:function(){for(var b,c,d=0;d<e.rules.length;d++){b=e.rules[d];for(var f=0;f<b.conditions.length;f++)if(c=b.conditions[f],("country"==c.condition||"city"==
c.condition)&&null==k("country"))return!0}return!1},states:{fetch_geo:{_onEnter:function(){g.bind(this.handle,this,"geo_data")},geo_data:function(b){k("country",b.country,{expires:1});k("city",b.city,{expires:1});this.transition("ready")}},ready:{_onEnter:function(){for(var b=0;b<e.rules.length;b++)this.rules.push(new Qa(e.rules[b]));m(this.namespace+": rules count="+this.rules.length+"; wait count="+g.where(this.rules,{state:"time_wait"}).length);this.emit("ready")}}},firstMessageTime:null,canInvite:!0,
importLegacy:function(){m(this.namespace+": importing from proactive_rules");for(var b,c=["contain","equal","regexp"],d=0;d<e.proactive_rules.length;d++){b=e.proactive_rules[d];g.defaults(b,{name:b.invitationText,urlPrefix:[{url:"/",mm:0}],page_timeout:20,close_timeout:300,enter_timeout:0,pages_count:0});for(var f=0;f<b.urlPrefix.length;f++)e.rules.push({legacyId:b.id,name:b.name,type:"all",conditions:[{condition:"online",value:!0},{condition:"time_on_page",comparator:"greater_equal",value:b.page_timeout},
{condition:"time_after_close",comparator:"greater_equal",value:b.close_timeout},{condition:"time_on_site",comparator:"greater_equal",value:b.enter_timeout},{condition:"pages_count",comparator:"greater_equal",value:b.pages_count},{condition:"page_url",comparator:c[b.urlPrefix[f].mm],value:b.urlPrefix[f].url}],commands:[{command:"proactive",params:{message:b.invitationText}}]})}},onJivoHandling:function(b){switch(b.inputType){case "gui_minimize":k("close_time",(new Date).getTime());break;case "gui_message":this.firstMessageTime||
(this.firstMessageTime=new Date);this.cancelRule("proactive");this.cancelRule("show_callform");break;case "accept":this.allRulesCancel();break;case "invitation":k("invitation_time",(new Date).getTime());break;case "callback_invitation":k("invitation_time",(new Date).getTime());break;case "move_close_button":g.each(this.rules,function(b){this.movedToCloseButton=!0;b.handle("tick")},this);break;case "move_scroll":g.each(this.rules,function(c){this.scrollPosition=b.args;c.handle("tick")},this);break;
case "api_open":b.args&&"object"===typeof b.args[0]&&"call"===b.args[0].start&&this.allRulesCancel()}},cancelRule:function(b){m(this.namespace+": cancel "+b);for(var c=0;c<this.rules.length;c+=1)"time_wait"===this.rules[c].state&&this.rules[c].commands[0].command===b&&this.rules[c].handle("cancel");"proactive"===b&&(this.canInvite=!1)},allRulesCancel:function(){for(var b=0;b<this.rules.length;b++)"time_wait"===this.rules[b].state&&this.rules[b].handle("cancel")},restoreAgentInfo:function(){var b=
k("agent_info");return b?{agent_id:b.split("$$")[0]}:!1},addOnceADayCookie:function(b){k(b,1,{expires:1,path:"/"})},showProactive:function(b,c,d,f){if(this.canInvite){if("number"==typeof b){var u=parseInt(b),C=!1;if(u){for(var n=0;n<this.rules.length;n++)if("proactive"==this.rules[n].commands[0].command&&this.rules[n].legacyId==u){b=this.rules[n].commands[0].params.message;m(this.namespace+": legacy rule found by ID="+u+"; message="+b);C=!0;break}if(!C){m(this.namespace+": legacy rule not found by ID="+
u);return}}}u=this.restoreAgentInfo();C={name:"active_agent"};c&&e.departments&&g.findWhere(e.departments,{id:c})&&(C.department=c);u&&(C.agent_id=u.agent_id);k("client_id")&&(C.jv_client_id=k("client_id"));fa(Y(e.widget_id,e.site_id),C,g.bind(function(c){-1!==g.indexOf(["uninitialized","WIDGET"],l.gui.state)&&(c?(l.handle("invitation",{name:d,invitationText:b},c),f&&this.addOnceADayCookie(f)):m("JIVO: invitation failed, no agent"))},this))}},showCallForm:function(b,c){ta(g.bind(function(d){d.show_form&&
-1!==g.indexOf(["uninitialized","WIDGET"],l.gui.state)&&(m("showCallForm title:"+b),l.handle("callback_invitation",{title:b}),l.soundPlayer.incomingMessage(),c&&this.addOnceADayCookie(c))},this))}}),X={content:g.template(["<!DOCTYPE html>\n<html>\n<head>\n<meta charset='utf-8'>","<link rel='stylesheet' href='"+z("/css/chat.css")+"'/>","\x3c!--[if lte IE 8]>","<link rel='stylesheet' href='"+z("/css/chat-ie8.css")+"' type='text/css' media='all'/>","<![endif]--\x3e\n<meta name='viewport' content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no'>\n<title>{{ title }}</title>\n</head>\n<body id='inner-chat' <% if (jivo.isTablet()) {%>class='tablet-version-widget'<% } %>>\n<div id='web_phone' class='phone_hidden'>\n<div id='rtc_placeholder'></div>\n<div id='up_arrow'></div>\n<div id='phone_hint'></div>\n</div>\n<div id='sound_player'></div>\n<div id='contents_placeholder'></div>",
"<script src='"+z("/js/chat_"+e.locale+".js")+"' charset='UTF-8'>\x3c/script>","</body>\n</html>"].join("\n")),chat:g.template("<div dir='ltr' class='jivo-triangle-wraper {{ jivo_config.style_string }}'>\n<div class='jivo-triangle-clip'>\n<div class='jivo-triangle jivo-chat-triangle'><div class='jivo-triangle-inner'></div></div>\n<div class='jivo-noise jivo-noise-pattern'></div>\n<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>\n<div class='jivo-top-right-square'>\n<div class='jivo-bottom-left-square'></div>\n</div>\n</div>\n</div>\n</div>\n<div id='jivo-drag-handle'></div>\n<div id='jivo-mouse-tracker' style='display: none'></div>\n<div dir='ltr' id='jivo_action' class='jivo-{{ mobile }}'>\n<div id='jivo_close_button' data-action='close'></div>\n</div>\n<div id='jivo_iframe_wrap'>\n<div id='jivo_iframe_placeholder'></div>\n</div>\n<div class='jivo-loader' id='jivo-loader'>\n<div class='jivo-loader-title' id='jivo-loader-title'>{{ lblLookingForFreeAgent }}</div>\n<div class='jivo-loader-inner'></div>\n</div>"),
label:{top:g.template("<div id='jivo_chat_widget_online'>\n<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>\n<div class='jivo-triangle-wraper {{ jivo_config.style_string }}'>\n<div class='jivo-triangle-clip'>\n<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>\n<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>\n<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>\n<div class='jivo-top-right-square'>\n<div class='jivo-bottom-left-square'></div>\n</div>\n</div>\n</div>\n</div>\n<div id='jivo-label-wrapper' style='height: {{ height }}px'>\n<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>\n<div id='jivo-label-text' <% if (locale) {%>class='jivo-{{ locale }}'<% } %>>{{ text }}</div>\n<div id='jivo-label-indicator'></div>\n<div id='jivo-label-status' class='jivo-{{ type }}'></div>\n</div>\n</div>\n</div>"),
bottom:g.template("<div id='jivo_chat_widget_online'>\n<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>\n<div class='jivo-triangle-wraper {{ jivo_config.style_string }}'>\n<div class='jivo-triangle-clip'>\n<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>\n<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>\n<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>\n<div class='jivo-top-right-square'>\n<div class='jivo-bottom-left-square'></div>\n</div>\n</div>\n</div>\n</div>\n<div id='jivo-label-wrapper' style='height: {{ height }}px'>\n<div id='jivo-label-status' class='jivo-{{ type }}'></div>\n<div id='jivo-label-text' <% if (locale) {%>class='jivo-{{ locale }}'<% } %>>{{ text }}</div>\n<div id='jivo-label-indicator'></div>\n<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>\n</div>\n</div>\n</div>"),
left:g.template("<div id='jivo_chat_widget_online'>\n<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>\n<div class='jivo-triangle-wraper {{ jivo_config.style_string }}'>\n<div class='jivo-triangle-clip'>\n<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>\n<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>\n<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>\n<div class='jivo-top-right-square'>\n<div class='jivo-bottom-left-square'></div>\n</div>\n</div>\n</div>\n</div>\n<div id='jivo-label-wrapper' style='width: {{ height }}px'>\n<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>\n<div id='jivo-label-text' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'>\n<div id='jivo-text-container'>\n<div>{{ text }}</div>\n</div>\n</div>\n<div id='jivo-label-status' class='jivo-{{ type }}'></div>\n<div id='jivo-label-indicator'></div>\n</div>\n</div>\n</div>"),
right:g.template("<div id='jivo_chat_widget_online'>\n<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>\n<div class='jivo-triangle-wraper {{ jivo_config.style_string }}'>\n<div class='jivo-triangle-clip'>\n<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>\n<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>\n<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>\n<div class='jivo-top-right-square'>\n<div class='jivo-bottom-left-square'></div>\n</div>\n</div>\n</div>\n</div>\n<div id='jivo-label-wrapper' style='width: {{ height }}px'>\n<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>\n<div id='jivo-label-text' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'>\n<div id='jivo-text-container'>\n<div>{{ text }}</div>\n</div>\n</div>\n<div id='jivo-label-status' class='jivo-{{ type }}'></div>\n<div id='jivo-label-indicator'></div>\n</div>\n</div>\n</div>")},
sound_player:g.template("<source src='{{ mp3 }}' type='audio/mpeg'>\n<source src='{{ ogg }}' type='audio/ogg; codecs=vorbis'>\n<source src='{{ wav }}' type='audio/wav'>")},Ra=y.extend({namespace:"WIDG",fade:!1,position:{},initialState:"HIDDEN",initialize:function(){this._templateData={orientation:e.widget_orientation,height:e.widget_height,style:e.style_string,text:"online"==e.chat_mode?e.online_widget_label:e.offline_widget_label,type:e.widget_font_color,locale:Ha()};this._widgetDiv=document.createElement("div");
this._widgetDiv.onclick=g.bind(this.handle,this,"click");this._widgetDiv.setAttribute("id","jivo_chat_widget");m(this._widgetDiv,X,e.widget_orientation,this._templateData);this._widgetDiv.innerHTML=X.label[e.widget_orientation](this._templateData);this.topWrap.appendChild(this._widgetDiv);this._el=document.getElementById("jivo-label");this.setColor();this.setFontStyle();this.setPosition()},isCustom:function(){return"none"===(this._widgetDiv.currentStyle?this._widgetDiv.currentStyle.display:getComputedStyle(this._widgetDiv,
null).display)},states:{VISIBLE:{_onEnter:function(){l.transferProportion({width:document.getElementById("jivo-label").offsetWidth,height:e.widget_height-0});this._el.style.display="block";this._hideLabelForCallWidget||(this._el.style.visibility="visible");this.fade&&F(this._el,"jivo-fade-in")},click:function(){l.isClicked=!0;l.handle("gui_maximize")},hide:"HIDDEN"},HIDDEN:{_onEnter:function(){M(this._el,"jivo-fade-in");this._el.style.visibility="hidden"},show:"VISIBLE",hide:function(){}}},getOffset:function(b){for(var c=
0,d=0;b&&!isNaN(b.offsetLeft)&&!isNaN(b.offsetTop);)c+=b.offsetLeft-b.scrollLeft,d+=b.offsetTop-b.scrollTop,b=b.offsetParent;return{top:d,left:c}},setText:function(b){if(this._widgetDiv){var c;0<=g.indexOf(["right","left"],e.widget_orientation)?(c=document.getElementById("jivo-text-container"),c=c.getElementsByTagName("div")[0]):c=document.getElementById("jivo-label-text");c.innerHTML=b;this.setPosition();this.position=Q(this._el)}},setColor:function(){this._containerDiv=document.getElementById("jivo-label-wrapper");
this._textContainer=document.getElementById("jivo-label-text");for(var b=E("jivo-label-triangle"),c=0;c<b.length;c++)switch(e.widget_orientation){case "top":b[c].style.borderTopColor=e.widget_color;break;case "bottom":b[c].style.borderLeftColor=e.widget_color;break;case "right":b[c].style.borderBottomColor=e.widget_color;break;case "left":b[c].style.borderLeftColor=e.widget_color}b=E("jivo-triangle-inner");for(c=0;c<b.length;c++)b[c].style.backgroundColor=e.widget_color;this._containerDiv&&(this._textContainer.style.fontSize=
e.font_size+"px",this._textContainer.style.fontFamily=e.font_family,this._isDarkText="dark"==e.widget_font_color,this._textContainer.style.color=this._isDarkText?"#222222":"#F0F1F1")},setOffline:function(){document.getElementById("jivo_chat_widget_online").setAttribute("id","jivo_chat_widget_offline");this.setText(e.offline_widget_label);for(var b=E("jivo-bottom-left-square"),c=0;c<b.length;c+=1)b[c].style.backgroundColor=e.widget_color},setOnline:function(){F(this._el,"jivo-online");M(this._el,"jivo-offline");
this.setText(e.online_widget_label);for(var b=E("jivo-bottom-left-square"),c=0;c<b.length;c+=1)b[c].style.backgroundColor="#44bb6e";b=E("jivo-css-leaf");for(c=0;c<b.length;c+=1)M(b[c],"jivo-offline"),F(b[c],"jivo-online")},setPosition:function(){var b=Q(this._el),c=30;switch(e.widget_orientation){case "left":case "right":var b=document.getElementById("jivo-text-container"),d=b.getElementsByTagName("div")[0];d.offsetWidth<d.offsetHeight?(b.style.width=d.offsetWidth+"px",b.style.height=d.offsetHeight+
"px"):(b.style.width=d.offsetHeight+"px",b.style.height=d.offsetWidth+"px");b=Q(this._el);switch(e.widget_padding){case "0":c=-30;break;case "50":c=b.height/2;break;case "100":c=b.height+10}this._el.style.top=e.widget_padding+"%";this._el.style.marginTop=-1*c+"px";this._el.style.width=e.widget_height+"px";break;case "top":case "bottom":switch(e.widget_padding){case "0":c=-30;break;case "50":c=b.width/2;break;case "100":c=b.width+10}"100"==e.widget_padding?(this._el.style.left="",this._el.style.right=
"30px"):(this._el.style.left=e.widget_padding+"%",this._el.style.right="",this._el.style.marginLeft=-1*c+"px");this._el.style.height=e.widget_height+"px"}},setFontStyle:function(){var b=document.getElementById("jivo-label-text");switch(e.font_type){case "normal":b.style.fontWeight="normal";b.style.fontStyle="normal";break;case "italic":b.style.fontWeight="normal";b.style.fontStyle="italic";break;case "bold":b.style.fontWeight="bold";b.style.fontStyle="normal";break;case "bold italic":b.style.fontWeight=
"bold",b.style.fontStyle="italic"}b.style.fontSize=e.font_size},getPosition:function(){return Q(document.getElementById("jivo-label"))}}),v=y.extend({namespace:"CHAT",mode:"online",_scrollOffset:0,_manualyScrolled:0,_chatDiv:0,_iframe:0,_iframeWrap:0,_doc:0,_window:0,_backgroundColor:0,_borderColor:0,_bodyColor:0,_onload_semaphore:!1,_event_queue:[],_getDoc:function(){if(this._iframe.contentDocument)return this._iframe.contentDocument;if(this._iframe.contentWindow)return this._iframe.contentWindow.document;
m("WARNING! chat_iframe._doc is null");return 0},iframeLoaded:function(){if(this._onload_semaphore){Ca(window,"scroll",this._onWindowScroll);try{this._window.chat_contents.init(this.mode,this.open_params,l.isClicked),l.isClicked=!1}catch(b){m("CHAT: iframe loaded, but contents is unreachable");return}this.handle("iframe_ready")}else this._onload_semaphore=!0;S.chrome()&&(document.body.scrollTop=this._manualyScrolled||this._scrollOffset)},_onWindowScroll:null,setColor:function(){this._isDarkText="dark"==
e.widget_font_color;this._backgroundColor=e.widget_color;this._borderColor=V(this._backgroundColor,.6,1);this._bodyColor=V(this._backgroundColor,1.15,.5);if(document.getElementById("jivo-chat")){var b;this._isDarkText?(V(this._backgroundColor,1.15,.7),b=V(this._backgroundColor,.1,.5)):(V(this._backgroundColor,.6,1),b="#ffffff");document.getElementById("jivo-loader-title").style.color=b}},setChatHeight:function(b){var c=document.getElementById("jivo-chat");m("Setting chat height: "+b);l.transferProportion({width:c.offsetWidth,
height:b});this._chatDiv.style.height=b+"px"},hide:function(){this._iframe.style.display="none";this._iframe.style.visibility="hidden";this._chatDiv.style.visibility="hidden";M(this._chatDiv,"jivo-fade-in")},show:function(){this._iframe.style.display="block";this._iframe.style.visibility="visible";this._chatDiv.style.visibility="visible";F(this._chatDiv,"jivo-fade-in")},getInitPosition:function(){var b={},c="top"==e.widget_orientation||"bottom"==e.widget_orientation;"left"==e.widget_orientation||
c&&0==e.widget_padding?b.left="30px":b.right="30px";"online"===e.chat_mode?(k("left")&&(b.left=k("left")),k("right")&&(b.right=k("right")),k("height")?b.height=k("height"):1==e.contacts_ask&&(b.height=this.getOnlineFormHeight())):b.height=this.getOfflineFormHeight();l.isTablet()&&!l.isSeparateWindow()&&(b.height=350);return b},getOfflineFormHeight:function(){var b=this.getOfflineDescriptionHeight(),b=b+(v.MESSAGE_OFFLINE_HEIGHT+v.INPUT_MARGIN);!e.contacts_settings.email.show&&e.contacts_settings.phone.show&&
e.contacts_settings.phone.required||(b+=v.INPUT_HEIGTH+v.INPUT_MARGIN);e.contacts_settings.name.show&&(b+=v.INPUT_HEIGTH+v.INPUT_MARGIN);e.contacts_settings.phone.show&&(b+=v.INPUT_HEIGTH+v.INPUT_MARGIN);e.options&8&&e.hide_ad||(b+=v.ADWORD_HEIGHT);b+=2*v.INNER_PADDING;b+=v.HEADER_OFFLINE_HEIGHT;b+=v.BUTTONS_HEIGHT;return b+"px"},getOfflineDescriptionHeight:function(){var b=document.createElement("div"),c;b.style.position="absolute";b.style.fontSize="16px";b.style.fontFamily="Arial, sans-serif";b.style.lineHeight=
"19px";b.style.visibility="hidden";b.style.width="247px";b.innerHTML=e.offline_form_text;document.body.appendChild(b);c=b.offsetHeight+v.DESCRIPTION_MARGIN;document.body.removeChild(b);return c},getOnlineFormHeight:function(){var b=v.MESSAGE_ONLINE_HEIGHT+v.INPUT_MARGIN;e.contacts_settings.email.show&&(b+=v.INPUT_HEIGTH+v.INPUT_MARGIN);b+=v.INPUT_HEIGTH+v.INPUT_MARGIN;e.contacts_settings.phone.show&&(b+=v.INPUT_HEIGTH+v.INPUT_MARGIN);e.departments&&(b+=v.INPUT_HEIGTH+v.INPUT_MARGIN);e.options&8&&
e.hide_ad||(b+=v.ADWORD_HEIGHT);b+=v.INNER_PADDING;b+=v.HEADER_ONLINE_HEIGHT;b+=v.BUTTONS_HEIGHT;b+=v.AVATAR_MARGIN;return Math.max(v.MIN_HEIGHT,b)+"px"},getPosition:function(){return Q(this._chatDiv)},initialize:function(){this._onWindowScroll=g.bind(function(){this._manualyScrolled=document.body.scrollTop},this);var b,c;this._chatDiv=document.createElement("div");this._chatDiv.setAttribute("id","jivo-chat");c=this.getInitPosition();for(b in c)this._chatDiv.style[b]=c[b];this._chatDiv.innerHTML=
X.chat({chatMode:e.chat_mode,mobile:"desktop",lblLookingForFreeAgent:r("lblLookingForFreeAgent")});this.topWrap.appendChild(this._chatDiv);this.setColor();c=E("jivo-chat-triangle");for(b=0;b<c.length;b++)c[b].style.borderLeftColor=e.widget_color;c=E("jivo-triangle-inner");for(b=0;b<c.length;b++)c[b].style.backgroundColor=e.widget_color;var d;d="offline"===e.chat_mode&&"offline"===l.gui.mode?e.widget_color:"#44bb6e";c=E("jivo-bottom-left-square");for(b=0;b<c.length;b+=1)c[b].style.backgroundColor=
d},states:{uninitialized:{show:function(b,c){this.mode=b;this.open_params=c;this.transition("LOADING_IFRAME")},resume_ok:function(b){this._event_queue.push(["resume_ok"].concat(g.toArray(arguments)));var c=b.client_info&&b.client_info.msg_history,d=e.chat_mode;c&&0<c.length&&(d="online");this.mode=d;this.transition("LOADING_IFRAME")},invitation:function(b,c){this._event_queue.push(["accept",{agent_info:b}]);this._event_queue.push(["agent_message",{message:c,invitation:!0}]);this.mode="online";this.transition("LOADING_IFRAME")}},
LOADING_IFRAME:{_onEnter:function(){this._scrollOffset=document.body.scrollTop||0;ra(window,"scroll",this._onWindowScroll);0<=g.indexOf([k("gui_state"),l.gui.state],"CHAT")&&(this._chatDiv.style.visibility="visible",F(this._chatDiv,"jivo-fade-in"));this._iframe=document.createElement("iframe");this._iframe.setAttribute("id","jivo_chat_iframe");this._iframe.setAttribute("frameBorder","0");this._iframe.setAttribute("scrolling","no");this._iframe.allowTransparency=!0;this._iframe.style.visibility="hidden";
this._iframeWrap=document.getElementById("jivo_iframe_placeholder");this._iframeWrap.appendChild(this._iframe);ea(this._iframe,g.bind(this.iframeLoaded,this));this._doc=this._getDoc();this._doc.open();var b={title:window.document.title,lblPhoneHint:r("lblPhoneHint")};this._doc.write(X.content(b));this._doc.close();this._window=this._iframe.contentWindow;this.iframeLoaded();F(this._chatDiv,"jivo-animated jivo-"+e.chat_mode)},iframe_ready:function(){delete this.open_params;l.gui.animationIsSupported()?
(F(document.getElementById("jivo-loader"),"jivo-fade-out"),F(this._iframe,"jivo-fade-in")):document.getElementById("jivo-loader").style.display="none";for(var b=0;b<this._event_queue.length;b++)this._window.chat_contents.handle.apply(this._window.chat_contents,this._event_queue[b]);this._event_queue=[];this.transition(0<=g.indexOf([k("gui_state"),l.gui.state],"CHAT")?"VISIBLE":"HIDDEN")},update_height:function(b){this.setChatHeight(b)},"*":function(){this._event_queue.push(g.toArray(arguments))},
invitation:function(b,c){this._event_queue.push(["accept",{agent_info:b}]);this._event_queue.push(["agent_message",{message:c,invitation:!0}]);this.mode="online"}},VISIBLE:{_onEnter:function(){var b=document.getElementById("jivo-chat");l.transferProportion({width:b.offsetWidth,height:b.offsetHeight});this.show()},hide:function(){this.transition("HIDDEN")},update_height:function(b){this.setChatHeight(b)},"*":function(){this._window.chat_contents.handle.apply(this._window.chat_contents,g.toArray(arguments))},
invitation:function(b,c){this._window.chat_contents.handle("accept",{agent_info:b});this._window.chat_contents.handle("agent_message",{message:c,invitation:!0})}},HIDDEN:{_onEnter:function(){this.hide()},show:function(b,c){this.transition("VISIBLE");this._window.chat_contents.handle(l.isClicked?"focus_maximize":"maximize",c||b);l.isClicked=!1},invitation:function(b,c){this._window.chat_contents.handle("accept",{agent_info:b});this._window.chat_contents.handle("agent_message",{message:c,invitation:!0});
this.transition("VISIBLE")},"*":function(){this._window.chat_contents.handle.apply(this._window.chat_contents,g.toArray(arguments))}}}},{INPUT_MARGIN:10,INPUT_HEIGTH:30,MESSAGE_OFFLINE_HEIGHT:109,BUTTONS_HEIGHT:28,HEADER_OFFLINE_HEIGHT:60,INNER_PADDING:10,ADWORD_HEIGHT:30,MESSAGE_ONLINE_HEIGHT:84,HEADER_ONLINE_HEIGHT:75,AVATAR_MARGIN:20,MIN_HEIGHT:372,DESCRIPTION_MARGIN:20}),Ua=y.extend({namespace:"GUI",mode:"online",animate:!1,unreadMessages:0,skipStoreState:!1,_event_queue:[],setOnline:function(){this.widget.setOnline();
this.mode="online";return this},setOffline:function(){"offline"!=this.mode&&(this._setButtonsOffline(),this.widget.setOffline(),this.mode="offline");return this},showWidget:function(b,c){this.enableAnimation(!!b);this.skipStoreState=!!c;this.handle("minimize");return this},showChat:function(b,c){l.isMobileOrTablet()?(l._callUserFunction("onOpen"),this.resetCounter(),this.openNewWindow()):(this.enableAnimation(!!b),this.handle("maximize",c));return this},showCallWidget:function(){this.widget._hideLabelForCallWidget=
!0;this.widget._el.style.visibility="hidden";"top"===e.widget_orientation||"bottom"===e.widget_orientation?this.widget._el.style.height=0:this.widget._el.style.width=0;this.handle("callwidget")},showInvitation:function(b,c){this.handle("invitation",b,c);return this},showLabelForCallWidget:function(){this.widget._hideLabelForCallWidget=!1;"VISIBLE"===this.widget.state&&(this.widget._el.style.visibility="visible");"top"===e.widget_orientation||"bottom"===e.widget_orientation?this.widget._el.style.height=
e.widget_height+"px":this.widget._el.style.width=e.widget_height+"px"},openNewWindow:function(){var b=window.location.protocol+jivo_config.base_url+"/script/window/"+jivo_config.widget_id,c=[],d=["client_id"];"online"===jivo_config.chat_mode&&d.push("sess_id");for(var f=0;f<d.length;f++)k(d[f])&&c.push(d[f]+"="+k(d[f]));d=l.getCurrentPage();c.push("url="+encodeURIComponent(d.url));c.push("title="+encodeURIComponent(d.title));c.length&&(b+="?"+c.join("&"));var g;l.isTablet()&&l.checkVisibilityAPI?
g=window.open(b,"jivo_"+e.widget_id):window.location=b;g&&g.focus()},getChatTop:function(){this.chat_top||(this.chat_top=new v({topWrap:this._wrapDiv}));return this.chat_top},chatInitialized:function(){return!!this.chat_top},incrementCounter:function(){var b=document.getElementById("jivo-label-indicator");b.innerHTML=++this.unreadMessages;b.style.visibility="visible"},resetCounter:function(){var b=document.getElementById("jivo-label-indicator");this.unreadMessages=0;b.style.visibility="hidden"},_setButtonsOffline:function(){for(var b=
!1,c=E("jivo-btn jivo-online-btn"),d=0;d<c.length;d++)b||(b=c[d].style.display),c[d].style.display="none";c=E("jivo-btn jivo-offline-btn");for(d=0;d<c.length;d++)c[d].style.display=b},highlight:function(b){},initialize:function(){this._wrapDiv=document.createElement("div");this._wrapDiv.setAttribute("id","jivo_top_wrap");document.body.appendChild(this._wrapDiv);g.defaults(e,{online_widget_label:r("defOnlineWidgetLabel"),offline_widget_label:r("defOfflineWidgetLabel"),offline_form_text:r("defOfflineFormText"),
contacts_settings:{name:{show:!1,required:!1},phone:{show:!1,required:!1},email:{show:!1,required:!1}}});Ga();l.isMobile()&&(e.online_widget_label=r("defOnlineWidgetLabelMobile")||e.online_widget_label,e.offline_widget_label=r("defOfflineWidgetLabelMobile")||e.offline_widget_label,e.widget_orientation="bottom",e.widget_padding=100,e.ignore_viewport&&(l.ignore_viewport=e.ignore_viewport));l.isWixIframe()&&(e.widget_orientation="bottom");this.widget=new Ra({topWrap:this._wrapDiv});this.copyright=new Sa;
this.animationIsSupported()&&(this.phantom=new Ta({topWrap:this._wrapDiv}),this.phantom.on("animated",g.bind(this.handle,this,"animate_finished")))},enableAnimation:function(b){!l.isWixIframe()&&b?(m("GUI : enabling animation"),this.animate=!0):(m("GUI : disabling animation"),this.animate=!1)},animationIsSupported:function(){var b;if(b=!this.widget.isCustom()){b=G.browser;var c=b.name;b=!!("Firefox"===c&&23<b.mV||"Chrome"===c&&28<b.mV||"Safari"===c&&5<b.mV)}return!!b},states:{uninitialized:{minimize:"WIDGET",
maximize:function(){this._event_queue.push(["show",this.mode]);this.transition("CHAT")},blacklist:"INVISIBLE",resume_ok:function(b){var c=b.client_info.msg_history;this.getChatTop().handle.apply(this.getChatTop(),["resume_ok"].concat(g.toArray(arguments)));if(g.findWhere(c,{type:"agentMessage",ack:0}))this.transition("CHAT");else{var c=k("gui_state"),d=b.client_info.cw_call&&b.client_info.cw_call.status;if(!c||"CALLWIDGET"===c&&!d||"CALLWIDGET"===c&&"cw_call_end"===d)c="WIDGET";this.transition(c)}}},
WIDGET:{_onEnter:function(){this.skipStoreState||k("gui_state",this.state);this.skipStoreState=!1;p.updateClient({chat_opened:!1});this.chatInitialized()&&this.getChatTop().handle("hide");this.widget.handle("show")},maximize:function(b){this.resetCounter();this._event_queue.push(["show",this.mode,b]);this.animationIsSupported()&&this.animate?this.transition("ANIMATE_EXPAND"):this.transition("CHAT")},callwidget:function(){this.transition("CALLWIDGET")},"*":function(b){l.isMobile()||l.isAndroid4old()&&
l.isTablet()?0<=g.indexOf(["agent_message","system_message","invitation","agent_service_message"],b)&&0<=g.indexOf(["agent_message","invitation","agent_service_message"],b)&&this.incrementCounter():("invitation"!==b&&this._event_queue.push(["show",this.mode]),this._event_queue.push(g.toArray(arguments)),0<=g.indexOf(["agent_message","invitation","agent_service_message"],b)?this.transition(this.animationIsSupported()?"ANIMATE_EXPAND":"CHAT"):"resume_ok"===b&&k("gui_state")&&"CHAT"===k("gui_state")&&
this.transition("CHAT"))},blacklist:function(){this.widget.handle("hide");this.transition("INVISIBLE")}},CHAT:{_onEnter:function(){k("gui_state",this.state);p.updateClient({chat_opened:!0});this.widget.handle("hide");l.getCallWidget()&&l.cw.callwidget.hideCallWidget();var b;for(l.transferProportion({width:this.getChatTop().getPosition().width,height:this.getChatTop().getPosition().height});b=this._event_queue.shift();)this.getChatTop().handle.apply(this.getChatTop(),b);this.widget.fade||(this.widget.fade=
!0)},minimize:function(){this.animationIsSupported()&&this.animate?this.transition("ANIMATE_COLLAPSE"):this.transition("WIDGET")},callwidget:function(){this.transition("CALLWIDGET")},"*":function(b){this.getChatTop().handle.apply(this.getChatTop(),g.toArray(arguments));"resume_ok"===b&&k("gui_state")&&"WIDGET"===k("gui_state")&&this.transition("WIDGET")},blacklist:function(){this.getChatTop().handle("hide")}},CALLWIDGET:{_onEnter:function(){k("gui_state",this.state);p.updateClient({chat_opened:!1});
this.chatInitialized()&&this.getChatTop().handle("hide");this.widget.handle("hide");this.widget.fade||(this.widget.fade=!0)},minimize:function(){this.transition("WIDGET")},maximize:function(b){this._event_queue.unshift(["show",b?b:this.mode]);this.animationIsSupported()&&this.animate?this.transition("ANIMATE_EXPAND"):this.transition("CHAT")},"*":function(b){this._event_queue.push(g.toArray(arguments));"agent_message"===b?this.handle("maximize"):"resume_ok"===b&&"CLOSED"===l.getCallWidget().state&&
this.transition("WIDGET")},blacklist:function(){this.getChatTop().handle("hide")}},ANIMATE_EXPAND:{_onEnter:function(){l.transferProportion({width:this.getChatTop().getPosition().width,height:this.getChatTop().getPosition().height});this.phantom.transition("HIDDEN");this.phantom.handle("expand",this.widget.getPosition(),this.getChatTop().getPosition());this.widget.handle("hide")},animate_finished:"CHAT",resume_ok:function(){this.getChatTop().handle.apply(this.getChatTop(),["resume_ok"].concat(g.toArray(arguments)))},
"*":function(b,c){this._event_queue.push(g.toArray(arguments))},blacklist:"INVISIBLE"},ANIMATE_COLLAPSE:{_onEnter:function(){l.transferProportion({width:this.widget.getPosition().width,height:this.widget.getPosition().height});this.phantom.transition("HIDDEN");this.phantom.handle("collapse",this.widget.getPosition(),this.getChatTop().getPosition());this.getChatTop().hide()},"*":function(b,c){this._event_queue.push(g.toArray(arguments))},animate_finished:"WIDGET",blacklist:"INVISIBLE"},INVISIBLE:{animate_finished:function(){this.widget.handle("hide");
this.getChatTop().handle("hide")}}}}),Sa=y.extend({namespace:"AD",initialState:"HIDDEN",disabled:!1,initialize:function(){var b=document.getElementById("jivo-label-copyright");if(G.showAd()){this.jivo_copyright=document.getElementById("jivo_copyright");this.jivo_copyright||(this.jivo_copyright=document.createElement("div"),this.jivo_copyright.innerHTML=r("seo_copyrightTextNew").replace("_COLOR_",e.widget_font_color),this.jivo_copyright.id="jivo_copyright",this.jivo_copyright.style.display="none",
document.body.appendChild(this.jivo_copyright));var c=document.createElement("div");c.setAttribute("id","jivo_copyright_corner");c.setAttribute("class","jivo-"+e.widget_orientation);switch(e.widget_orientation){case "top":c.style.borderBottomColor=e.widget_color;break;case "left":c.style.borderRightColor=e.widget_color;break;case "right":c.style.borderLeftColor=e.widget_color;break;case "bottom":c.style.borderTopColor=e.widget_color}this.jivo_copyright.style.backgroundColor=e.widget_color;this.jivo_copyright.appendChild(c);
for(var c=this.jivo_copyright.getElementsByTagName("a"),d=0;d<c.length;d++)c[d].href+="?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=widget_popup&utm_campaign=self_ad";l.isMobile()||(b.onmouseover=g.bind(this.handle,this,"ad_mouseover"),b.onmouseout=g.bind(this.handle,this,"ad_mouseout"),this.jivo_copyright.onmouseover=g.bind(this.handle,this,"copyright_mouseover"),this.jivo_copyright.onmouseout=g.bind(this.handle,this,"copyright_mouseout"))}else F(b,"jivo-no-copyright"),
this.disabled=!0},getTooltipPosition:function(b){b=Q(b);var c=Q(document.getElementById("jivo_copyright")),d={top:0,left:0};switch(e.widget_orientation){case "left":d={top:b.top+20,left:b.left+b.width+10};ca&&(d={top:b.top,left:b.left+b.width+10});break;case "right":d={top:b.top+20,left:b.left-c.width-10};break;case "top":d={top:b.top+(b.height+15),left:b.left+40};break;case "bottom":d={bottom:b.height+10,left:b.left+(b.width-c.width)-40}}return d},states:{HIDDEN:{_onEnter:function(){this.disabled||
(this.jivo_copyright.style.display="none")},ad_mouseover:"VISIBLE"},VISIBLE:{_onEnter:function(){this.jivo_copyright.style.display="block";var b=this.getTooltipPosition(document.getElementById("jivo-label"));this.jivo_copyright.style.left=b.left+"px";"undefined"!=typeof b.bottom?this.jivo_copyright.style.bottom=b.bottom+"px":this.jivo_copyright.style.top=b.top+"px"},ad_mouseout:function(){this._scheduleEvent("hide",700)},hide:"HIDDEN",copyright_mouseover:function(){this._cancelEvent("hide")},copyright_mouseout:function(){this._scheduleEvent("hide",
700)}}}}),P=new y({namespace:"TITLE",title:"",startBlink:function(){this.handle("start")},stopBlink:function(){this.handle("stop")},_messageShown:!1,_showMessage:function(){document.title=r("lblNewMessage");this._messageShown=!0},_showTitle:function(){document.title=this.title;this._messageShown=!1},states:{uninitialized:{start:"blinking"},blinking:{_onEnter:function(){this.title=document.title;this._showMessage();this._scheduleEvent("blink",1E3)},blink:function(){this._messageShown?this._showTitle():
this._showMessage();this._scheduleEvent("blink",1E3)},stop:function(){this._showTitle();this._cancelEvent("blink");this.transition("uninitialized")}}}}),l=window.jivo=new y({namespace:"JIVO",_chatWindow:!1,_forcedCurrentPage:!1,_forcedOffline:!1,checkVisibilityAPI:!0,invitationText:!1,agentInfo:!1,ruleName:!1,isClicked:!1,initialize:function(){var b=g.bind(this.handle,this,"window.loaded");if(window.parentSandboxBridge&&window.parentSandboxBridge.inAir)var c=setInterval(function(){m("check for document.readyState: "+
document.readyState);if("complete"===document.readyState||"loaded"===document.readyState)l.handle("window.loaded"),clearInterval(c)},300);else"complete"===document.readyState?setTimeout(b):document.addEventListener?(document.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",b,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",b),window.attachEvent("onload",b)),this.device=S},initializeMachines:function(){this.gui=new Ua;!e.callback_widget||this.cw||this.isMobileOrTablet()||
this.initCallWidget();this.soundPlayer=Va;this.soundPlayer.initialize(document.getElementById("jivo_top_wrap"));e.form_observer&&!this.isSeparateWindow()&&new Wa},_changeBrowserLocation:function(b,c){"function"===typeof window.parent.history.pushState&&window.parent.history.pushState({},c,b)},_newSession:function(){k("sess_id",null);if(!this.isSeparateWindow()){if("offline"===e.chat_mode&&G.hideOffline()){this.transition("HIDDEN");return}if(e.options&16){this.transition("INIT_RULE_MANAGER");return}"online"===
e.chat_mode?(this.isVisitorsInsight()&&p.handle("startup"),this.transition("ONLINE")):this.transition("OFFLINE")}this.gui.showWidget()},_listenMessages:function(b){m("JIVO: listening for window messages");"addEventListener"in window?window.addEventListener("message",g.bind(this._windowMessage,this,b),!1):"attachEvent"in window&&window.attachEvent("message",g.bind(this._windowMessage,this,b))},_windowMessage:function(b,c){this.handle([b,c.data.action].join("_"),c)},isVisitorsInsight:function(){return 1===
e.visitors_insight},isMobile:function(){return S.mobile()},isTablet:function(){return S.tablet()},isMobileOrTablet:function(){return this.isMobile()||this.isTablet()},isAndroid4old:function(){var b=navigator.userAgent,c=!1;0<=b.indexOf("Android")&&(b=parseFloat(b.slice(b.indexOf("Android")+8)),4===b||4.1===b||4.2===b)&&(c=!0);return c},isWixIframe:function(){return"undefined"!==typeof jivo_in_wix_iframe},isSeparateWindow:function(){return"undefined"!==typeof jivo_newWindow},getCallWidget:function(){return this.cw&&
this.cw.callwidget},initCallWidget:function(){var b={currentState:"",position:{top:0,left:0},seconds:e.callback_widget,initTimer:e.callback_widget,agent_info:""};if(this.resumed_context&&this.resumed_context.client_info.cw_call){b.currentState=l.resumed_context.client_info.cw_call.status;if("cw_call_end"===b.currentState||"cw_error"===b.currentState)b.currentState="CLOSED";b.agent_info=this.resumed_context.agent_info}else b.agent_info=null;b.currentState&&(-1!==g.indexOf(["cw_connected","cw_connecting",
"cw_error","cw_call_end"],b.currentState)?b.initialState="CALL":b.initialState="WAIT",b.priorAction=b.currentState);"CLOSED"===b.currentState&&(b.initialState="CLOSED");this.cw||(this.cw={});this.cw.callwidget=new Xa(b);m("jivo.js init cw")},createMagicIFrame:function(){this.isMobile()||this.isTablet()||this.isSeparateWindow()||this.isWixIframe()||Aa.create()},_callUserFunction:function(b,c){b="jivo_"+b;if("function"===typeof window[b])try{m("JIVO: calling user function "+b),window[b](c),m("JIVO: user function "+
b+" returned")}catch(d){}},_sendIntroduce:function(b){p.sendIfConnected({name:"introduction",client_name:b.name,phone:b.phone,email:b.email});this._saveClientInfo(b)},_saveClientInfo:function(b){g.each(["name","phone","email"],function(c){c in b&&""!==b[c]&&("name"===c?k("client_name",b[c],{expires:365,path:"/"}):k(c,b[c],{expires:365,path:"/"}))})},_chatAccepted:function(){B.trackChatConnected();this._callUserFunction("onAccepted")},transferProportion:function(b){this._callUserFunction("onResizeCallback",
b)},getCurrentPage:function(){return this._forcedCurrentPage?this._forcedCurrentPage:{url:window.location.href,title:document.title.substr(0,255)}},getChatHeight:function(){return document.getElementById("jivo-chat").offsetHeight},_stripHashFromLocation:function(b){0<window.location.href.indexOf("#jvhs_"+b)&&this._changeBrowserLocation(window.location.href.replace("#jvhs_"+b,""),document.title)},pageVisible:function(){return"visibilityState"in document?"visible"===document.visibilityState:"webkitVisibilityState"in
document?"visible"===document.webkitVisibilityState:!1},_listenVisibility:function(){m("Installing visibility event handler");var b,c;"undefined"!==typeof document.hidden?(c="visibilitychange",b="visibilityState"):"undefined"!==typeof document.mozHidden?(c="mozvisibilitychange",b="mozVisibilityState"):"undefined"!==typeof document.msHidden?(c="msvisibilitychange",b="msVisibilityState"):"undefined"!==typeof document.webkitHidden&&(c="webkitvisibilitychange",b="webkitVisibilityState");"addEventListener"in
document&&"undefined"!==typeof c?document.addEventListener(c,g.bind(this._visibleHandler,this,b),!1):this.checkVisibilityAPI=!1},_visibleHandler:function(b){this.handle("window_"+document[b]);p.updateClient({page_visible:this.pageVisible()})},_isBlacklisted:function(){var b=k("client_id");return b&&0===b.indexOf("z")},_inAir:function(){return window.parentSandboxBridge&&window.parentSandboxBridge.inAir},_sendRate:function(b,c){},handleGuiTransition:function(b){"WIDGET"===b.toState?this._callUserFunction("onClose"):
"CHAT"===b.toState&&this._callUserFunction("onOpen")},callWidgetEvents:function(b,c){0===b.lastIndexOf("cw_",0)&&(m(b,this.state,g.toArray(arguments)),this.cw?"cw_cancel_call"===b?p.send({name:b}):"cw_call"===b?p.send({name:b,tel:c.tel,invitation_text:c.invitation_text||!1}):"cw_ping"===b?p.send({name:b,title:g.toArray(arguments)[1]||!1}):this.emit.apply(this,g.toArray(arguments)):m("JIVO: Call widget not initialized."))},updateHeight:function(b){"update_height"===b&&this.gui.handle.apply(this.gui,
g.toArray(arguments))},"*":function(b,c){this.updateHeight(b,c);m(this.namespace+": unhandled "+b+" in state "+this.state)},states:{uninitialized:{"window.loaded":function(){if(!k("enter_ts")){k("enter_ts",(new Date).getTime());if(document.referrer){k("refer",document.referrer);var b=window.location.href,b=b.substr(b.indexOf("?")+1).split("&"),c,d,f="";for(d=b.length;d--;)c=b[d].split("="),0<=c[0].indexOf("utm_")&&(c=b[d],f+=(0<f.length?"|":"")+c.substr(c.indexOf("utm_")+4));f&&k("utm",f)}b=k("visits_count")-
0;k("visits_count",b?b+1:1,{expires:365,path:"/"})}this.isSeparateWindow()?(this._listenVisibility(),b=Z("url"),c=Z("title"),b&&c&&(this._forcedCurrentPage={url:b,title:c.substr(0,255)}),(b=Z("client_id"))&&k("client_id",b),b=Z("sess_id"),e.chat_mode=b?"online":"offline",this.initializeMachines(),b?(k("sess_id",b,{expires:1,path:"/"}),this.transition("CHECKING_SESSION")):this.transition("OFFLINE")):this._isBlacklisted()||this.isMobileOrTablet()&&e.disable_mobile?this.transition("HIDDEN"):this.transition("LOADING_CSS")}},
LOADING_CSS:{_onEnter:function(){if(document.createStyleSheet)document.createStyleSheet(z("/css/label.css")),ca&&document.createStyleSheet(z("/css/label-ie8.css")),S.windowsPhone()&&document.createStyleSheet(z("/css/label-wp.css")),e.callback_widget&&!this.isMobileOrTablet()&&document.createStyleSheet(z("/css/call-widget.css"));else{var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("href",z("/css/label.css"));var c=G.browser;if("Opera"===c.name||"Safari"===c.name&&
6>c.mV||"Firefox"===c.name&&12>c.mV)c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("href",z("/css/label-ie8.css")),document.body.appendChild(c);document.body.appendChild(b);S.windowsPhone()&&(b=document.createElement("link"),b.setAttribute("rel","stylesheet"),b.setAttribute("href",z("/css/label-wp.css")),document.body.appendChild(b));e.callback_widget&&!this.isMobileOrTablet()&&(b=document.createElement("link"),b.setAttribute("rel","stylesheet"),b.setAttribute("href",
z("/css/call-widget.css")),document.body.appendChild(b))}b=this.cssDetector=document.createElement("div");b.id="jivo_css_detector";b.style.visibility="hidden";b.style.position="absolute";document.body.appendChild(b);this._scheduleEvent("timer_css",100)},timer_css:function(){if(0<this.cssDetector.offsetWidth){this.initializeMachines();try{if(this._inAir()){window.parentSandboxBridge.process("onIframeDomReady");this.transition("HIDDEN");return}}catch(c){}this.gui.on("transition",g.bind(this.handleGuiTransition,
this));var b=window.location.hash.split("jvhs_");g.isUndefined(b[1])||this.gui.highlight(b[1]);if(window!=window.top){try{if(window.top.jivo_magic_var===jivo_magic_var&&!this.isWixIframe()){this.transition("IN_IFRAME");this._callUserFunction("onLoadCallbackSS");return}}catch(c){}if(!this.isWixIframe()){this.transition("HIDDEN");return}}this.isSeparateWindow()||(this._listenVisibility(),this._callUserFunction("onLoadCallbackSS"));k("sess_id")?this.transition("CHECKING_SESSION"):this._newSession()}else this._scheduleEvent("timer_css",
100)},gui_introduced:function(b){this._saveClientInfo(b)}},CHECKING_SESSION:{_onEnter:function(){var b=k("sess_id"),c=this.getCurrentPage();Y(b,e.site_id,e.widget_id);c.title.substr(0,255);g.bind(this.handle,this,"check_session_response");this._scheduleEvent("timer_check_session",4E3)},check_session_response:function(b){m("JIVO: Check session response",b);this._cancelEvent("timer_check_session");"object"===typeof b&&"ok"===b.result?b.has_connection?this.pageVisible()?this.transition("RESUMING"):(this.transition(e.chat_mode.toUpperCase()),
this.gui.showWidget(!1,!0)):this.transition("RESUMING"):this._newSession()},timer_check_session:function(){U({message:"Check session Timeout"});this._newSession()}},RESUMING:{_onEnter:function(){p.resume(k("sess_id"))},resume_ok:function(b){this.resumed_context=b;var c=this.getCallWidget(),d;c&&(this.resumed_context.client_info.cw_call?(d=this.resumed_context.client_info.cw_call.status,"cw_wait"===d?(m("resume on cw_wait, handle_start_timer"),c.handle("start_timer")):c.handle(d)):c.handle("CLOSED"));
(c=b.client_info.msg_history)&&c.length&&(c=b.client_info.msg_history=g.reject(c,function(b){return b.implicit}));c&&g.findWhere(c,{type:"clientMessage"})&&this.createMagicIFrame();var f=e.chat_mode.toUpperCase();c&&0<c.length&&(f="ONLINE",e.chat_mode="online");this.transition(f);!this.isMobileOrTablet()||this.isSeparateWindow()?this.isSeparateWindow()||!this.isVisitorsInsight()||!c||0!==c.length||b.agent_info||d?this.gui.handle("resume_ok",b):this.transition("INIT_RULE_MANAGER"):(this.gui.showWidget(),
g.each(c,function(b){"agentMessage"!==b.type||b.ack||this.gui.incrementCounter()},this),g.findWhere(c,{type:"agentMessage",ack:0})||this.gui.resetCounter())},resume_failed:function(){this._newSession()}},HIDDEN:{},IN_IFRAME:{_onEnter:function(){k("mframe",null);window.parent.jivo.handle("iframe_url_change",window.location.href,document.title)},highlight_cobrowse:function(b){this.gui.highlight(b)},gui_introduced:function(b,c){this._sendIntroduce(b);c||(B.trackGaveContacts(),this._callUserFunction("onIntroduction"))},
"*":function(b){0<=g.indexOf(["api_open","gui_close_cobrowse","gui_message"],b)?window.parent.jivo.handle.apply(window.parent.jivo,g.toArray(arguments)):m("JIVO: unhandled "+b+" in "+this.state)}},INIT_RULE_MANAGER:{_onEnter:function(){H.isInited?this.handle("rule_manager_ready"):(H.on("ready",g.bind(this.handle,this,"rule_manager_ready")),H.init())},rule_manager_ready:function(){"online"===e.chat_mode?(this.isVisitorsInsight()&&p.handle("startup"),this.transition("ONLINE")):this.transition("OFFLINE");
this.gui.showWidget()},hide:"HIDDEN"},ONLINE:{_onEnter:function(){this.gui.setOnline()},api_open:function(b){this.handle("gui_maximize",b)},invitation:function(b,c){p.updateClient({chat_opened:!0,page_visible:this.pageVisible(),proactive_rule:{invitation_text:b.invitationText,agent_id:c.agent_id}});B.trackProactiveInvitationShown(b.name);this.ruleName=b.name;this.invitationText=b.invitationText;this.agentInfo=c;this.gui.showInvitation(this.agentInfo,this.invitationText);this.transition("PROACTIVE")},
callback_invitation:function(b){var c=this.getCallWidget();c&&c.handle("cw_show_form",{show_form:1,title:b.title});B.trackCallWidgetInvitationShown(b.title)},highlight_cobrowse:function(b){this.gui.highlight(b)},gui_close_cobrowse:function(b){this._stripHashFromLocation(b)},gui_maximize:function(b){this.openParams=b;this.isMobileOrTablet()&&!k("sess_id")?this.transition("STARTING_SESSION"):(B.trackChatOpenedByClick(),this.gui.showChat(!0,this.openParams))},gui_callwidget:function(){this.gui.showCallWidget()},
gui_answer_proactive:function(){k("sess_id")&&this.gui.showChat(!0,this.openParams)},gui_typing:function(b){p.sendIfConnected({name:"client_typing",typing:b})},gui_introduced:function(b,c){this._sendIntroduce(b);c||(B.trackGaveContacts(),this._callUserFunction("onIntroduction"))},gui_message:function(b,c){this.createMagicIFrame();var d={name:"client_message",message:b};c&&(d=g.extend(d,c));this.department_id&&(d.widget_department_id=this.department_id,this.department_id=null);p.send(d);d.implicit||
this.gui.handle("gui_message",b)},gui_department:function(b){this.department_id=b},gui_typing_insight:function(b){p.sendIfConnected({name:"client_service_message",service:"typing_insight",event:"input_changed",new_val:b})},gui_minimize:function(){P.stopBlink();this.gui.showWidget(!0)},gui_decline_file:function(b,c){P.stopBlink();p.send({name:"client_service_message",service:"file_transfer",file_id:b,file_name:c,event:"file_declined"})},gui_receive_file:function(b,c){P.stopBlink();p.send({name:"client_service_message",
service:"file_transfer",file_id:b,file_name:c,event:"file_received"})},gui_accept_cobrowse:function(b,c){P.stopBlink();var d=document.location.href.split("#")[0],e=b+"#jvhs_"+c,g=document.getElementById("jivo_magic_iframe");if(d===b||d===encodeURI(b)){try{d=window,g&&(d=g.contentWindow),d.jivo.handle("highlight_cobrowse",c)}catch(k){m(k.toString());return}this._changeBrowserLocation(e,document.title)}else this.isMobileOrTablet()?window.open(e,document.title):g?Aa.navigate(e):document.location.href=
e},gui_evaluation:function(b,c){this._sendRate(b,c)},agent_chat_close:function(b){this.invitationText=this.agentInfo=!1;this.gui.handle("agent_chat_close",b)},gui_msg_input_focus:function(){P.stopBlink()},"*":function(b,c){this.callWidgetEvents(b,c);0<=g.indexOf("agent_message agent_service_message system_message agent_typing accept gui_resume update_height transferred update_agent_info blacklist cw_show_form cw_connected cw_connecting cw_call_end".split(" "),b)?(this.gui.handle.apply(this.gui,g.toArray(arguments)),
0<=g.indexOf(["agent_message","agent_service_message"],b)&&(P.startBlink(),this.isVisitorsInsight()&&c.msg_id&&1===c.msg_id&&!this.invitationText&&1===e.contacts_ask&&(this.invitationText=c.message)),"accept"===b&&this._chatAccepted()):m("JIVO: unhandled "+b+" in "+this.state)},iframe_url_change:function(b,c){this._changeBrowserLocation(b,c);p.sendIfConnected({name:"url_change",url:b,title:c.substr(0,255)})},reopened_elsewhere:function(){P.stopBlink();this.gui.showWidget(!1,!0)},connect_failed:function(){this._forcedOffline=
"connect_failed";this.transition("OFFLINE");this.gui.handle("connect_failed")},force_offline:function(b){this._forcedOffline=b.err_code?b.err_code:b.name;this.transition("OFFLINE");this.gui.handle("connect_failed")},window_visible:function(){!p.isConnected()&&k("sess_id")&&this.transition("CHECKING_SESSION")},gui_start_call:function(){p.send({name:"request_call",want_call:1})},gui_agent_message_ack:function(b){p.sendIfConnected({name:"agent_message_ack",ack_msg_ids:b})}},OFFLINE:{_onEnter:function(){P.stopBlink();
this.gui.setOffline()},callback_invitation:function(b){var c=this.getCallWidget();c&&c.handle("cw_show_form",{show_form:1,title:b.title});B.trackCallWidgetInvitationShown(b.title)},gui_maximize:function(){B.trackOfflineFormOpenedByClick();this.gui.showChat(!0)},gui_minimize:function(){this.gui.showWidget(!0)},gui_callwidget:function(){this.gui.showCallWidget()},gui_offline_message:function(b){this._saveClientInfo(b);p.send({name:"offline_message",message:b.message,email:b.email,phone:b.phone,client_name:b.name,
cap_symbols:b.cap_symbols,from_online:this._forcedOffline});this.transition("OFFLINE_WAIT")},gui_leave_msg:function(){this.gui.handle("gui_leave_msg")},api_open:function(){this.handle("gui_maximize")},window_visible:function(){var b=this.getCallWidget();!p.isConnected()&&k("sess_id")?this.transition("CHECKING_SESSION"):k("sess_id")||"CALLWIDGET"!==this.gui.state||-1===g.indexOf(["CALL","WAIT"],b.state)||b.handle("cw_call_end")},"*":function(b,c){this.callWidgetEvents(b,c);this.updateHeight(b,c)}},
OFFLINE_WAIT:{_onEnter:function(){this._scheduleEvent("message_timer",0)},offline_ack:function(b){},message_timer:function(){window.IPclhrData&&4==Number(window.IPclhrData.consultantOn)?(B.trackOfflineMessageSent(),this.gui.handle("offline_success")):this.gui.handle("offline_failed");this.transition("OFFLINE")}},PROACTIVE:{gui_minimize:function(){B.trackProactiveInvitationRejected(this.ruleName);this.gui.showWidget(!0);this.transition("ONLINE")},gui_message:function(b,c){this.createMagicIFrame();
B.trackProactiveInvitationAccepted(this.ruleName);k("agent_info",""+this.agentInfo.agent_id);if(!this.isMobileOrTablet()){var d={name:"client_message",message:b};c&&(d=g.extend(d,c));p.send(d);d.implicit||(this.gui.handle("gui_message",b),this.transition("ONLINE"))}},gui_answer_proactive:function(){this.transition("STARTING_SESSION")},gui_maximize:function(){this.isMobileOrTablet()&&(B.trackProactiveInvitationAccepted(this.ruleName),this.transition("STARTING_SESSION"))},gui_introduced:function(b,
c){this._sendIntroduce(b);c||(B.trackGaveContacts(),this._callUserFunction("onIntroduction"))},window_visible:function(){!p.isConnected()&&k("sess_id")&&this.transition("CHECKING_SESSION")},api_open:function(b){this.transition("ONLINE");this.handle("api_open",b)},accept:function(){this.transition("ONLINE");this._chatAccepted()},cw_ping:function(b,c){this.transition("ONLINE");p.sendIfConnected({name:"cw_ping",title:g.toArray(arguments)[1]||!1})}},STARTING_SESSION:{_onEnter:function(){p.handle("startup")},
startup_ok:function(){this.transition("ONLINE");this.gui.showChat(!0,this.openParams)},gui_maximize:function(b){this.gui.showChat(!0,b)}}}});"object"!==typeof JSON&&(JSON={});(function(){function b(b){return 10>b?"0"+b:b}function c(b){g.lastIndex=0;return g.test(b)?'"'+b.replace(g,function(b){var c=l[b];return"string"===typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function d(b,e){var f,g,l,u,N=k,r,p=e[b];p&&"object"===typeof p&&"function"===typeof p.toJSON&&(p=
p.toJSON(b));"function"===typeof m&&(p=m.call(e,b,p));switch(typeof p){case "string":return c(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";k+=n;r=[];if("[object Array]"===Object.prototype.toString.apply(p)){u=p.length;for(f=0;f<u;f+=1)r[f]=d(f,p)||"null";l=0===r.length?"[]":k?"[\n"+k+r.join(",\n"+k)+"\n"+N+"]":"["+r.join(",")+"]";k=N;return l}if(m&&"object"===typeof m)for(u=m.length,f=0;f<u;f+=1)"string"===typeof m[f]&&
(g=m[f],(l=d(g,p))&&r.push(c(g)+(k?": ":":")+l));else for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&(l=d(g,p))&&r.push(c(g)+(k?": ":":")+l);l=0===r.length?"{}":k?"{\n"+k+r.join(",\n"+k)+"\n"+N+"}":"{"+r.join(",")+"}";k=N;return l}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+
"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k,n,l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,
c,e){var f;n=k="";if("number"===typeof e)for(f=0;f<e;f+=1)n+=" ";else"string"===typeof e&&(n=e);if((m=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return d("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(b,c){function d(b,e){var f,g,k=b[e];if(k&&"object"===typeof k)for(f in k)Object.prototype.hasOwnProperty.call(k,f)&&(g=d(k,f),void 0!==g?k[f]=g:delete k[f]);return c.call(b,e,k)}var g;b=String(b);e.lastIndex=0;e.test(b)&&
(b=b.replace(e,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return g=eval("("+b+")"),"function"===typeof c?d({"":g},""):g;throw new SyntaxError("JSON.parse");})})();(function(b){var c=b.setTimeout,d=b.document,e=0;b.jivoXHR=function(){function g(){try{t.parentNode.removeChild(t)}catch(b){}}
function k(b){try{q.onerror.call(q,b,m)}catch(c){throw Error(b);}}function n(){this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||p||(this.onload=this.onreadystatechange=null,p=!0,4!==q.readyState&&k("Script failed to load ["+m+"]."),g())}function l(b){b=b||[];q.readyState=4;q.status=200;"function"===typeof q.onload&&q.onload.apply(q,b)}var m,p,t,q=null,q={onerror:null,onload:null,readyState:0,open:function(c,d){p=!1;m="";g();t=null;var n="cb"+e++;(function(c){b.jivoXHR[c]=
function(){try{l.call(q,arguments)}catch(d){q.readyState=-1,k(d.message)}b.jivoXHR[c]=null}})(n);m=d.replace(/=\?/,"=jivoXHR."+n)},send:function(){c(function(){t=d.createElement("script");t.setAttribute("type","text/javascript");t.charset="UTF-8";t.onload=t.onreadystatechange=function(){n.call(t)};t.setAttribute("src",m);d.getElementsByTagName("head")[0].appendChild(t)},0)},abort:function(){},setRequestHeader:function(){},getResponseHeader:function(){return""},getAllResponseHeaders:function(){return[]}};
p=!1;m="";g();t=null;return q}})(window);var p=new y({namespace:"CONMANAGER",msg_buf:[],jconnection:null,send:function(b){m("SEND: ",b);this.handle("send",b)},sendIfConnected:function(b){this.isConnected()&&(m("SEND IF CONNECTION: ",b),this.handle("send",b))},resume:function(){this.handle("resume")},setupConnection:function(){if(!this.jconnection){var b=[];b.unshift("https://"+e.comet.host+"/cometcn");k("use_lp")||Na||b.unshift("wss://"+e.comet.host+"/cometcn");m("CONNECTION: url",b);this.jconnection=
new G.Connection(b);this.jconnection.on("connecting",g.bind(this.handle,this,"socket_connecting"));this.jconnection.on("open",g.bind(this.handle,this,"socket_connect"));this.jconnection.on("close",g.bind(this.handle,this,"socket_disconnect"));this.jconnection.on("error",function(b){m("CONNECTION: error",b.name+": "+b.message)});this.jconnection.on("message",function(b){var d;try{d=JSON.parse(b)}catch(e){return m("ERROR parse error",e)}if(!d||"object"!==typeof d)return m("ERROR bad message");p.handle("socket_message",
d)});this.jconnection.open()}},_sendSocketEvent:function(b){var c;try{c=JSON.stringify(b)}catch(d){return m("ERROR stringify error",d)}"object"==typeof b?"name"in b?(m("Sending "+b.name),(b=this.jconnection.send(c))&&m("ERROR send error",b)):m("ERROR Attempt to send event without name"):m("ERROR Socket event must be object")},_bufferMessage:function(b){this.msg_buf.push(b)},_flushMessageBuffer:function(){for(var b;b=this.msg_buf.shift();)this._sendSocketEvent(b)},isConnected:function(){return"CONNECTED"===
this.state},setCustomData:function(b){this.isConnected()?this.send({name:"update_custom_data",custom_data:b}):this.custom_data=b},setUserToken:function(b){this.isConnected()?this.send({name:"update_user_token",user_token:b}):this.user_token=b},createClientModel:function(){this.clientModel||(this.clientModel={chat_opened:"CHAT"===k("gui_state"),page_visible:l.pageVisible()})},updateClient:function(b){var c={name:"update_client",jv_sess_id:k("sess_id")};this.createClientModel();var d=g.clone(this.clientModel);
g.extend(this.clientModel,b);g.isEqual(this.clientModel,d)||(g.extend(c,b),this.sendIfConnected(c))},requestTelemetry:function(b){var c=this.jconnection,d={};c&&(d.state=c.state,d.url=c.url,d.health=c.health);ga(b,d)},states:{uninitialized:{_onEnter:function(){this.jconnection&&(this.jconnection.off(),this.jconnection.close(),this.jconnection=null)},send:function(b){this._bufferMessage(b);this.transition("CONNECTING")},resume:function(){this.transition("CONNECTING")},startup:function(){k("sess_id",
null);this.transition("CONNECTING")}},CONNECTING:{_onEnter:function(){this.setupConnection()},socket_connect:function(){0==this.jconnection.url.indexOf("http")&&k("use_lp",1);k("sess_id")?this.transition("RESUMING"):this.transition("STARTING_UP")},send:function(b){this._bufferMessage(b)},socket_disconnect:function(){this.requestTelemetry("Disconnected while connecting");this.transition("uninitialized")},socket_connecting:function(){}},STARTING_UP:{_onEnter:function(){this.createClientModel();var b=
{name:"startup",jv_widget_id:e.widget_id,site_id:e.site_id,current_page:l.getCurrentPage(),is_mobile:l.isMobile(),visits_count:k("visits_count")-0},b=g.extend(b,this.clientModel);k("client_id")&&(b.jv_client_id=k("client_id"),m("CONNECTION: restored client #"+b.jv_client_id));k("__utmz")&&(b.g_utmz=k("__utmz"));k("agent_info")&&(b.pa_id=k("agent_info").split("$$")[0],m("CONNECTION: restored agent #"+b.pa_id));k("client_name")&&(b.client_name=k("client_name"),m("CONNECTION: restored client name="+
b.client_name));k("email")&&(b.email=k("email"),m("CONNECTION: restored client email="+b.email));k("phone")&&(b.phone=k("phone"),m("CONNECTION: restored client phone="+b.phone));k("refer")&&(b.refer=k("refer"),k("utm")&&(b.utm=k("utm")));l.invitationText&&(b.proactive_rule={invitation_text:l.invitationText,agent_info:l.agentInfo});this.custom_data&&(b.custom_data=this.custom_data);this.user_token&&(b.user_token=this.user_token);this._sendSocketEvent(b);this._scheduleEvent("startup_timeout",3E3)},
startup_timeout:function(){this.requestTelemetry("Startup Timeout")},send:function(b){this._bufferMessage(b)},socket_message:function(b){"startup_ok"===b.name?(this._cancelEvent("startup_timeout"),k("sess_id",b.jv_sess_id,{expires:1,path:"/"}),k("client_id",b.jv_client_id,{expires:365,path:"/"}),this.transition("CONNECTED")):"startup_error"===b.name&&(l.handle("force_offline",b),this.transition("DISCONNECTING"))}},RESUMING:{_onEnter:function(){this.createClientModel();this._sendSocketEvent(g.extend({name:"resume",
jv_sess_id:k("sess_id"),jv_widget_id:e.widget_id,site_id:e.site_id,visits_count:k("visits_count")-0,separate_window:l.isSeparateWindow(),current_page:l.getCurrentPage()},this.clientModel));this._scheduleEvent("resume_timeout",3E3)},socket_message:function(b){this._cancelEvent("resume_timeout");"resume_ok"==b.name?(l.handle(b.name,b),this.transition("CONNECTED")):(l.handle("resume_failed"),this.transition("STARTING_UP"))},resume_timeout:function(){this.requestTelemetry("Resume Timeout")}},CONNECTED:{_onEnter:function(){l.handle("startup_ok");
this._flushMessageBuffer()},socket_message:function(b){switch(b.name){case "agent_chat_close":l.isVisitorsInsight()||this.transition("DISCONNECTING");break;case "force_offline":this.transition("DISCONNECTING");break;case "blacklist":k("client_id","z"+k("client_id"));this.transition("DISCONNECTING");break;case "cw_call_end":case "cw_error":"OFFLINE"==l.state&&this.transition("DISCONNECTING");break;case "accept":case "transferred":k("agent_info",""+b.agent_info.agent_id);break;case "offline_ack":"cap_id"in
b||this.transition("DISCONNECTING")}l.handle(b.name,b)},send:function(b){this._sendSocketEvent(b)},socket_disconnect:function(b){m("CONNECTION: close",b.wasClean,b.code,b.reason);1E3==b.code&&l.handle("reopened_elsewhere");this.transition("uninitialized")},startup:function(){l.handle("startup_ok")},socket_connecting:function(){setTimeout(g.bind(function(){this.requestTelemetry("JC reconnect")},this),2E3);this.transition("CONNECTING")}},DISCONNECTING:{_onEnter:function(){k("sess_id",null);this.jconnection.close()},
socket_disconnect:function(b){this.transition("uninitialized")}}}}),Ta=y.extend({namespace:"PHANTOM",element:!1,type:"chat",PHANTOM_ID:"jivo_phantom",TIMEOUT_TRANSITION:300,TIMEOUT_TRANSITION_DEBOUNCE:1,initialize:function(){var b=this.element=document.createElement("div");b.id=this.PHANTOM_ID;Ea(b,"TransitionEnd",this.handleTransitionEnd);this.topWrap.appendChild(b);F(b,"jivo-"+e.widget_orientation);b.style.background=e.widget_color;this.handleTransitionEnd=g.debounce(g.bind(function(){this._transitionEndTimeout&&
clearTimeout(this._transitionEndTimeout);this.handle("animate_finished")},this),this.TIMEOUT_TRANSITION_DEBOUNCE)},setRect:function(b){Fa(this.element,b);return this},setTransition:function(b){qa(this.element,"jivo-notransition",!b);return this},animate:function(b,c){var d=this.element,e="EXPANDING"===this.state;qa(d,"jivo-phantom-chat",e);qa(d,"jivo-phantom-label",!e);this.setTransition(!1).setRect(b,!0).setTransition(!0);setTimeout(g.bind(function(){this.setRect(c);this._transitionEndTimeout=setTimeout(this.handleTransitionEnd,
this.TIMEOUT_TRANSITION)},this),0)},initialState:"HIDDEN",states:{ANIMATED:{_onEnter:function(){this.emit("animated");this._scheduleEvent("hide",this.TIMEOUT_TRANSITION)},hide:"HIDDEN"},HIDDEN:{_onEnter:function(){this.setTransition(!1)},collapse:function(b,c){this.transition("COLLAPSING");this.animate(c,b)},expand:function(b,c){this.transition("EXPANDING");this.animate(b,c)}},EXPANDING:{animate_finished:"ANIMATED"},COLLAPSING:{animate_finished:"ANIMATED"}}}),B={_yaCounter:!1,_trackedEvents:[],_trackEvent:function(b,
c){},_setCustomVar:function(b,c){},findYaCounter:function(){},trackChatOpenedByClick:function(){this._trackEvent("Chat requested","User clicked chat widget")},trackOfflineFormOpenedByClick:function(){this._trackEvent("Offline form shown","User offline form")},trackOfflineMessageSent:function(){this._trackEvent("Offline message sent","User sent message via offline form")},trackProactiveInvitationShown:function(b){this._trackEvent("Proactive invitation shown",b)},trackProactiveInvitationAccepted:function(b){this._trackEvent("Proactive invitation accepted",
b)},trackProactiveInvitationRejected:function(b){this._trackEvent("Proactive invitation rejected",b)},trackChatConnected:function(){this._trackEvent("Chat established","User connected to agent")},trackGaveContacts:function(){this._trackEvent("User gave contacts during chat","User gave contacts during chat")},trackCallWidgetInvitationShown:function(b){this._trackEvent("Callback invitation shown",b)},trackCallWidgetRequested:function(b){this._trackEvent("Callback requested",b)},setABTestGroupContacts:function(b,
c){this._setCustomVar(b,c)}};B.findYaCounter();window.jivo_api={open:function(b){var c=l.getCallWidget();"object"===typeof b&&"call"===b.start&&c?ta(g.bind(function(d){d.show_form&&"WIDGET"===l.gui.state?l.handle("cw_show_form",{show_form:1}):l.handle("api_open",b);c.analyticsTitle="apiCall"},this),{title:!1,invitation:"jivo_api.open"}):l.handle("api_open",b)},getContactInfo:function(){if(g.find(G.fields,function(b){return k(b)})){var b={};g.each(G.fields,function(c){k(c)&&(b["client_name"===c?"name":
c]=k(c))});return b}},getVisitorNumber:function(b){var c=k("client_id");c&&0<c.indexOf(".")&&"function"===typeof b?setTimeout(function(){b(null,c.split(".").shift())},0):fa(Y(e.widget_id,e.site_id),{name:"visitor_number"},function(c){"object"===typeof c&&c.result&&"client_id"in c&&(k("client_id",c.client_id,{expires:365,path:"/"}),"function"===typeof b?b(null,c.client_id.split(".").shift()):b(Error("Error fetching visitor number")))})},setUserToken:function(b){("string"===typeof b||b instanceof String)&&
p.setUserToken(b)},setCustomData:function(b){"[object Array]"===Object.prototype.toString.call(b)&&p.setCustomData(b)},sendMessage:function(b,c){"[object Object]"===Object.prototype.toString.call(b)&&ua(b,c+" \n")},setContactInfo:function(b){if(b&&"object"===typeof b)for(var c in b){var d=b[c],e={},m=!1;g.find(G.fields,function(b){return"client_name"===b?"name"===c:b===c})&&!k("name"===c?"client_name":c)&&G["isValidValue_"+c](d)&&(e[c]=d,m=!0);m&&l.handle("gui_introduced",e,!0)}},showProactiveInvitation:function(b,
c){H.showProactive(b,c,"jivo_api.showProactiveInvitation")},setRules:function(b){b&&"object"===typeof b&&(e.rules=b)},chatMode:function(){return e.chat_mode}};var Wa=function(){function b(b){m("JIVO SUBMIT EVENT",b);b=b.target;var c="Form"+(b.id?' id="'+b.id+'"':"")+(b.action?' action="'+b.action+'"':"")+" submitted: \n",e={};g.each(b.elements,function(b){b.name&&(e[b.name]=b.value)},this);ua(e,c)}var c=g.bind(document.querySelectorAll,document)("form");m("JIVO OBSERVER, FORMS:",c);g.each(c,function(c){if(0<
c.elements.length&&!g.findWhere(c.elements,{type:"password"})){m("FORM Observer: ",c);ra(c,"submit",b);var e=c.submit;c.submit=function(){try{b({target:this})}catch(c){U(c)}e.call(this)}}})},Aa={frm:0,create:function(){if(e.disable_iframe)m("Magic iframe is disabled");else if(this.frm)m("Magic iframe already created");else if(k("mframe"))m("Magic iframe create cancelled, page may be protected from iframe");else{k("mframe",1);m("Creating iframe");var b=document.createElement("iframe");b.setAttribute("id",
"jivo_magic_iframe");b.setAttribute("class","jivo-frame-hidden");b.setAttribute("frameborder","0px");b.setAttribute("name","col_old_page");document.body.appendChild(b);b.contentWindow.location=window.location;this.frm=b;ea(b,g.bind(this.onFrameLoaded,this))}},onFrameLoaded:function(){m("Magic frame content loaded. Time to show the frame...");document.getElementById("jivo_top_wrap");document.body.setAttribute("id","jivo_outer_body");document.body.style.overflow="hidden";document.body.scroll="no";for(var b=
document.getElementsByTagName("iframe"),c=0;c<b.length;c++){var d=b[c];"jivo_magic_iframe"!=d.id&&"jivo_chat_iframe"!=d.id&&(d.style.display="none")}this.frm.setAttribute("class","jivo-frame-visible");this.frm.style.display="block";this.hasScroll().vScrollbar&&(b=this.getScrollBarWidth()+"px",m("Adjusting right margin. Scroll width="+b),document.getElementById("jivo-chat").style.marginRight=b,document.getElementById("jivo-label").style.marginRight=b);this.syncPageScroll()},navigate:function(b){m("navigating iframe to ",
b);this.frm.contentDocument.location.href=b},getDoc:function(){var b=this.frm.contentWindow.document;b||(b=this.frm.contentDocument);return b?b:(m("Cannot find document!! :("),0)},syncPageScroll:function(){var b=0,c=0;"number"==typeof window.pageYOffset?(c=window.pageYOffset,b=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(c=document.body.scrollTop,b=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&
(c=document.documentElement.scrollTop,b=document.documentElement.scrollLeft);m("scroll pos x="+b+" y="+c);this.frm.contentWindow.scrollTo(b,c)},getScrollBarWidth:function(){var b=document.createElement("div");b.style.visibility="hidden";b.style.width="100px";document.body.appendChild(b);var c=b.offsetWidth;b.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%";b.appendChild(d);d=d.offsetWidth;b.parentNode.removeChild(b);return c-d},hasScroll:function(){var b={vScrollbar:!0,
hScrollbar:!0};try{var c="BackCompat"==document.compatMode?document.body:document.documentElement;b.vScrollbar=c.scrollHeight>c.clientHeight;b.hScrollbar=c.scrollWidth>c.clientWidth}catch(d){}return b}};(function(b,c){b.VMasker=c()})(this,function(){var b=[8,9,16,17,18,36,37,38,39,40,91,92,93],c=function(c){for(var d=0,e=b.length;d<e;d++)if(c==b[d])return!1;return!0},d=function(b){b=b||{};b={precision:b.hasOwnProperty("precision")?b.precision:2,separator:b.separator||",",delimiter:b.delimiter||".",
unit:b.unit&&b.unit.replace(/[\s]/g,"")+" "||"",suffixUnit:b.suffixUnit&&" "+b.suffixUnit.replace(/[\s]/g,"")||"",zeroCents:b.zeroCents,lastOutput:b.lastOutput};b.moneyPrecision=b.zeroCents?0:b.precision;return b},e=function(b,c,d){for(;c<b.length;c++)if("9"===b[c]||"A"===b[c]||"S"===b[c])b[c]=d;return b},g=function(b){this.elements=b};g.prototype.unbindElementToMask=function(){for(var b=0,c=this.elements.length;b<c;b++)this.elements[b].lastOutput="",this.elements[b].onkeyup=!1,this.elements[b].onkeydown=
!1,this.elements[b].value.length&&(this.elements[b].value=this.elements[b].value.replace(/\D/g,""))};g.prototype.bindElementToMask=function(b){for(var d=this,e=function(e){e=e||window.event;var f=e.target||e.srcElement;c(e.keyCode)&&setTimeout(function(){d.opts.lastOutput=f.lastOutput;f.value=k[b](f.value,d.opts);f.lastOutput=f.value;f.setSelectionRange&&d.opts.suffixUnit&&f.setSelectionRange(f.value.length,f.value.length-d.opts.suffixUnit.length)},0);l.cw.callwidget.checkTel(e)},f=0,g=this.elements.length;f<
g;f++)this.elements[f].lastOutput="",this.elements[f].onkeyup=e,this.elements[f].value.length&&(this.elements[f].value=k[b](this.elements[f].value,this.opts))};g.prototype.maskMoney=function(b){this.opts=d(b);this.bindElementToMask("toMoney")};g.prototype.maskNumber=function(){this.opts={};this.bindElementToMask("toNumber")};g.prototype.maskAlphaNum=function(){this.opts={};this.bindElementToMask("toAlphaNumeric")};g.prototype.maskPattern=function(b){this.opts={pattern:b};this.bindElementToMask("toPattern")};
g.prototype.unMask=function(){this.unbindElementToMask()};var k=function(b){if(!b)throw Error("VanillaMasker: There is no element to bind.");return new g("length"in b?b.length?b:[]:[b])};k.toMoney=function(b,c){c=d(c);if(c.zeroCents){c.lastOutput=c.lastOutput||"";var e=new RegExp("("+c.separator+"[0]{0,"+c.precision+"})","g"),f=b.toString().replace(/[\D]/g,"").length||0,g=c.lastOutput.toString().replace(/[\D]/g,"").length||0;b=b.toString().replace(e,"");f<g&&(b=b.slice(0,b.length-1))}for(var k=b.toString().replace(/[\D]/g,
""),l=new RegExp("^(0|\\"+c.delimiter+")"),e=new RegExp("(\\"+c.separator+")$"),m=k.substr(0,k.length-c.moneyPrecision),f=m.substr(0,m.length%3),g=Array(c.precision+1).join("0"),m=m.substr(m.length%3,m.length),p=0,r=m.length;p<r;p++)0===p%3&&(f+=c.delimiter),f+=m[p];f=f.replace(l,"");f=f.length?f:"0";c.zeroCents||(k=k.substr(k.length-c.precision,c.precision),l=k.length,g=(g+k).slice(-(c.precision>l?c.precision:l)));return(c.unit+f+c.separator+g+c.suffixUnit).replace(e,"")};k.toPattern=function(b,
c){var d="object"===typeof c?c.pattern:c,g=d.replace(/\W/g,""),d=d.split(""),k=b.toString().replace(/\W/g,""),l=k.replace(/\W/g,""),m=0,p,r=d.length,u="object"===typeof c?c.placeholder:void 0;for(p=0;p<r;p++)if(m>=k.length){if(g.length==l.length)return d.join("");if(void 0!==u&&g.length>l.length)return e(d,p,u).join("");break}else if("9"===d[p]&&k[m].match(/[0-9]/)||"A"===d[p]&&k[m].match(/[a-zA-Z]/)||"S"===d[p]&&k[m].match(/[0-9a-zA-Z]/))d[p]=k[m++];else if("9"===d[p]||"A"===d[p]||"S"===d[p])return void 0!==
u?e(d,p,u).join(""):d.slice(0,p).join("");return d.join("").substr(0,p)};k.toNumber=function(b){return b.toString().replace(/(?!^-)[^0-9]/g,"")};k.toAlphaNumeric=function(b){return b.toString().replace(/[^a-z0-9 ]+/i,"")};return k});window.coBrowserIframeCreater=function(){var b,c,d=!1,e=[],g=!1,k={},l=function(p,r){m("coBrowserIframeCreater has received event "+p);var t=document.getElementById("jivo_frame");t||(t=Ba.init(function(){m("jivoFrame has been inited");b&&b.postMessage({name:"widget_ready"},
c);d=!0;l()}));if(d){if(e.length){var q=e.shift();p=q.name;r=q.params}g?(m("controller of childSandboxBridge set as for NodeWebkit"),t=t.contentWindow.jqueryFrameControllerForAir,t.setLangpack(k),q=document.createElement("link"),q.setAttribute("rel","stylesheet"),q.setAttribute("href",z("/css/for_air.css")),document.body.appendChild(q),t.init()):t=t.contentWindow.jqueryFrameController;if(t[p]&&"is_node_webkit"!=p)t[p](r);else m("controller has not "+p);e.length&&l()}else e.push({name:p,params:r})},
p=!1;(function(b,c,d){b.addEventListener?b.addEventListener(c,d,!1):b.attachEvent&&(b.attachEvent("on"+c,function(b){return function(){d.call(b,window.event)}}(b)),b=null)})(window,"message",function(d){var e=d.data;"in_node_webkit"==e.name&&(b||(b=d.source,c=d.origin),g=!0,k=e.langpack,p=!0);p&&c==d.origin&&l(e.name,e)},!1);return{process:function(b,c){l(b,c)},postMessage:function(d){b&&b.postMessage(d,c)},isNodeWebkit:function(){return g}}}();window.childSandboxBridge={_queue:[],_ready:0,_inAir:0,
process:function(b,c){var d=document.getElementById("jivo_frame");d||(window.parentSandboxBridge&&window.parentSandboxBridge.inAir&&(this._inAir=!0),d=Ba.init(function(){m("jivoFrame has been inited");window.parentSandboxBridge&&window.parentSandboxBridge.process("onJqueryIframeReady");childSandboxBridge._ready=!0;childSandboxBridge.process()}));if(this._ready){if(this._queue.length){var e=this._queue.shift();b=e.name;c=e.params}this.inAir()?(m("controller of childSandboxBridge set as for Air"),d=
d.contentWindow.jqueryFrameControllerForAir,e=document.createElement("link"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",z("/css/for_air.css")),document.body.appendChild(e),d.init()):d=d.contentWindow.jqueryFrameController;m("childSandboxBridge has received event "+b);if(d[b])d[b](c);else m("controller has not "+b);this._queue.length&&this.process()}else this._queue.push({name:b,params:c})},inAir:function(){return this._inAir}};window.parentSandboxBridge&&(m=function(b){window.parentSandboxBridge.log(b)},
m("parentSandboxBridge.initInterface() called"),window.parentSandboxBridge.initInterface());var Ba={_content:"<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>\t\t<html>\t\t<head>\t\t\t<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />\t\t\t<script type='text/javascript'  src='"+z("/js/jquery_frame.js")+"'>\x3c/script>\t\t\t<script type='text/javascript'>    lblDefaultCobrowseComment='"+r("lblDefaultCobrowseComment")+
"';\t\t\t\x3c/script>\t\t</head>\t\t<body >\t\t</body>        </html>",_iframe:0,init:function(b){this._iframe=document.createElement("iframe");this._iframe.setAttribute("id","jivo_frame");this._iframe.setAttribute("frameBorder","0");this._iframe.setAttribute("scrolling","no");this._iframe.allowTransparency=!0;this._iframe.style.backgroundColor="transparent";this._iframe.style.display="none";window.document.body.appendChild(this._iframe);ea(this._iframe,b);this._doc=this._getDoc();this._doc.open();
this._doc.write(this._content);this._doc.close();this._window=this._iframe.contentWindow;this._iframe.contentWindow.controller=this;return this._iframe},_getDoc:function(){if(this._iframe.contentDocument)return this._iframe.contentDocument;if(this._iframe.contentWindow)return this._iframe.contentWindow.document;m("WARNING! chat_iframe._doc is null");return 0}},Ya=g.template(["<div class='jivo-call-form jivo-call-form-low' style='display:none;'>\n<div class='jivo-form-box'>\n<div class='jivo-form-inner'>",
"<a href='#' title='"+r("cw_close")+"' class='jivo-close-form'></a>","<div class='jivo-form-header'>\n<div class='jivo-form-low-phone'></div>\n<div class='jivo-call-text'>","<span class='jivo-text-center'>"+r("cw_weRecallAfter")+" <span class='jivo-text-time'>28</span> <span class='jivo-text-sec'>"+r("cw_seconds")+"</span>!</span>","</div>\n</div>\n<div class='jivo-error-header'>","<div class='jivo-title-ce'>"+r("cw_unableToConnect")+"</div>","<div class='jivo-call-repeat'>","<div class='jivo-err-info'>"+
r("cw_errInfoText")+"</div>","</div>\n</div>\n<div id='jivo-call-form'>\n<div class='jivo-call-form-shadow'>\n<div class='jivo-tel-box'>","<div class='jivo-tel-placeholder'>"+r("cw_enterPhonePlaceholder")+"</div>","<span class='jivo-tel-pre-code'>+7</span>\x3c!--input id='jivo-call-code' type='tel' name='jivo-code' maxlength='3' placeholder='___'/><span class='jivo-tel-after-code'>)</span--\x3e\n<input id='jivo-call-tel' type='tel' value='' name='jivo-tel' maxlength='12' placeholder='926 123 4567'/>\n</div>\n</div>",
"<a id='jivo-save-tel' title='"+r("cw_callButtonText")+"'><i class='jivo-call-icon'></i>"+r("cw_callButtonText")+"</a>","</div>\n<div class='jivo-call-copy'>\n<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>\n</div>\n<a href='http://ipsite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>\n</div>\n<div id='jivo-call-container'></div>\n</div>\n</div>"].join("\n")),
Za=g.template(["<div class='jivo-call-action jivo-hidden' style='display: none;'>\n<div class='jivo-call-step jivo-call-wait'>","<div class='jivo-text-ca'>"+r("cw_callAfter")+"</div>","<div id='jivo-timer-block' class='jivo-timer-block'>\n<div class='jivo-call-loader' data-anim='base wrapper'>\n<div class='jivo-call-circle' data-anim='base left'></div>\n<div class='jivo-call-circle' data-anim='base right'></div>\n</div>\n<div class='jivo-action-timer'>\n<span id='jivo-time' class='jivo-time'>28</span>\n</div>",
"</div>"+r("cw_seconds")+"</div>","<div class='jivo-call-step jivo-call-connecting'>\n<div class='jivo-call-box-wrap'>\n<div class='jivo-circle jivo-anim-circle'></div><div class='jivo-circle jivo-anim-circle2'></div>\n<div class='jivo-call-box'>\n<i class='jivo-connecting-icon'><i class='jivo-anim-wait'></i></i>\n</div>\n</div>","<div class='jivo-text-conn'>"+r("cw_connecting")+"</div>","</div>\n<div class='jivo-call-step jivo-call-connected'>\n<div class='jivo-call-box'>\n<div class='jivo-call-up'>\n<i class='jivo-calling-icon'></i>translate('cw_weCalling')<br>",
"<span class='jivo-calling-up-phone'>"+r("cw_pickUpPhone")+"</span>","</div>\n<div class='jivo-call-online'>\n<div class='jivo-operator-icon'>","<img id='jivo-operator-icon' src='"+e.base_url+"/images/jivo-ico-operator.png' alt=''/>","<i class='jivo-operator-icon-mobile'></i>\n</div>\n<div class='jivo-operator-name'>\n\u041a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u0438\u043d<br>\n\u041c\u0430\u043d\u0436\u0435\u043d\u043a\u043e\n<small>\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440-\u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442</small>\n</div>",
"<div class='jivo-connected-show-chat'>"+r("cw_chat")+"</div>","</div>\n<div class='jivo-call-end'>\n<a href='#' class='jivo-close-form'></a>\n<div class='jivo-end-box'>","<div class='jivo-thx-text'>"+r("cw_thxForCall")+"</div>","<a href='#' class='jivo-btn-recall'>"+r("cw_repeatCallAgain")+"</a>","<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>\n</div>\n</div>\n</div>\n</div>\n<a href='http://ipsite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>\n</div>\n<div class='jivo-call-error jivo-call-step' style='display: none;'>\n<div class='jivo-end-close'></div>",
"<div class='jivo-title-ce'>"+r("cw_unableToConnect")+"</div>","<div class='jivo-call-repeat'>","<div class='jivo-err-info'>"+r("cw_errInfoText")+"</div>","</div>\n<div id='jivo-call-form'>\n<div class='jivo-call-form-shadow'>\n<div class='jivo-tel-box'>","<div class='jivo-tel-placeholder'>"+r("cw_enterPhonePlaceholder")+"</div>","<span class='jivo-tel-pre-code'>+7</span>\x3c!--input id='jivo-call-code' type='tel' name='jivo-code' maxlength='3' placeholder='___'/><span class='jivo-tel-after-code'>)</span--\x3e\n<input id='jivo-call-tel' type='tel' name='jivo-tel' maxlength='12' placeholder='926 123 4567'/>\n</div>\n</div>",
"<a id='jivo-save-tel' title='"+r("cw_callButtonText")+"'><i class='jivo-call-icon'></i>"+r("cw_callButtonText")+"</a>","</div>\n<div class='jivo-call-copy'>\n<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>\n</div>\n<a href='http://ipsite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>\n<div class='jivo-report-form'>",
"<p>"+r("cw_reportPlaceholder")+"</p>","\x3c!--div class='jivo-text-right'>","<a href='#' class='jivo-btn jivo-btn-report'>"+r("cw_textSend")+"</a>","</div--\x3e\n</div>\n</div>"].join("\n")),Xa=y.extend({initialState:"CLOSED",namespace:"CALLWIDGET",formType:2,templateForm:Ya,templateCall:Za,containerForm:"jivo-form-container",containerCall:"jivo-call-container",form:null,call:null,phone:0,timer:0,clickClosedForm:!0,initTel:function(){this.phone=document.getElementById("jivo-call-tel");var b=k("phone"),
c;b&&(b=b.substring(2,12),c=document.getElementById("jivo-call-tel"),c.value=b,M(c,"jivo-disabled"));this.actionForElements(".jivo-start-chat",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.transition("FORMHIDDEN");this.guiMaximize()},this)});this.initMask()},checkTel:function(b){var c=this.phone=document.getElementById("jivo-call-tel");b=b.keyCode||b.whitch;12===c.value.toString().length&&M(c,"jivo-disabled");13===b&&document.getElementById("jivo-save-tel").click()},initMask:function(){VMasker(this.phone).maskPattern("999 999 9999")},
guiMaximize:function(){l.isClicked=!0;l.handle("gui_maximize")},actionForElements:function(b,c){"."===b.charAt(0)?g.each(E(b.substr(1)),c,this):g.each([document.getElementById(b.substr(1))],c,this)},showElement:function(b){if(!g.isArray(b)){var c=[];c.push(b);b=c}g.each(b,function(b){this.actionForElements(b,function(b){b.style.display="block"})},this)},hideElement:function(b){if(!g.isArray(b)){var c=[];c.push(b);b=c}g.each(b,function(b){this.actionForElements(b,function(b){b.style.display="none"})},
this)},addClass:function(b,c){this.actionForElements(b,function(b){F(b,c)})},removeClass:function(b,c){this.actionForElements(b,function(b){M(b,c)})},showAction:function(){this.showElement(".jivo-call-action")},drawTimer:function(b){var c=3.6*b;50<b?(this.addClass(".jivo-call-loader","gt50"),g.each(E("jivo-call-circle"),function(b,c){1===c&&F(b,"fill")},this)):(this.removeClass(".jivo-call-loader","gt50"),g.each(E("jivo-call-circle"),function(b,c){1===c&&M(b,"fill")},this));this.actionForElements(".jivo-call-circle",
function(b){b.style.webkitTransform="rotate("+c+"deg)";b.style.MozTransform="rotate("+c+"deg)";b.style.msTransform="rotate("+c+"deg)";b.style.OTransform="rotate("+c+"deg)";b.style.transform="rotate("+c+"deg)"})},center:function(b){b.css({position:"fixed",top:"50%",left:"50%",margin:"-141px 0 0 -"+b.width()/2+"px"})},secOfNum:function(b){var c=[2,0,1,1,1,2];return[r("cw_form_second"),r("cw_form_seconds"),r("cw_form_secondd")][4<b%100&&20>b%100?2:c[5>b%10?b%10:5]]},initialize:function(){if(document.getElementById(this.containerCall))m("JivoCall already initialized.");
else{var b={sendMessage:"online"===e.chat_mode?r("cw_typeInChat"):r("lblLeaveMessage")};this.form=document.createElement("div");this.form.setAttribute("id",this.containerForm);this.form.innerHTML=this.templateForm(b);l.gui._wrapDiv.appendChild(this.form);this.call=document.getElementById(this.containerCall);this.call.innerHTML=this.templateCall(b);this.showElement(["#"+this.containerForm,"#"+this.containerCall]);this.actionForElements(".jivo-call-form",function(b){b.onclick=g.bind(function(b){b.preventDefault();
b.stopPropagation();this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-form-box",function(b){b.onclick=g.bind(function(b){b.stopPropagation()},this)})}window.onresize=g.throttle(g.bind(function(){this.actionForElements(".jivo-call-form",function(b){b.style.left=l.gui.getChatTop().getPosition().left+"px";b.style.right="auto"})},this),100);g.each("cw_wait cw_connecting cw_calling cw_connected cw_error cw_call_end cw_show_form".split(" "),g.bind(function(b){l.on(b,g.bind(function(d){this.handle(b,
d)},this))},this));l.on("startup_ok",g.bind(function(b){this.resumed_context.client_info.cw_call&&this.handle(this.resumed_context.client_info.cw_call.status,b)},this));this.initTel();this.actionForElements(".jivo-close-form",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.clickClosedForm=!0;l.gui.widget.handle("show");this.transition("FORMHIDDEN")},this)});if(l.gui.animationIsSupported())l.gui.phantom.on("transition",g.bind(this.handlePhantomTranstion,this));this.actionForElements("#jivo-save-tel",
function(b){b.onclick=g.bind(this.clickTel,this)});this.actionForElements(".jivo-call-close",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-btn-recall",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.hideElement(".jivo-call-error");this.transition("FORMVISIBLE")},this)});this.actionForElements(".jivo-btn-start-chat",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.hideElement(".jivo-call-end");
this.transition("FORMHIDDEN");this.guiMaximize()},this)});this.actionForElements(".jivo-end-close",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.clickClosedForm=!0;this.hideElement(".jivo-call-end");this.removeClass(".jivo-call-error","jivo-error-visible");setTimeout(g.bind(function(){this.hideElement(".jivo-call-error")},this),200);this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-btn-report",function(b){b.onclick=g.bind(function(b){b.preventDefault();this.hideElement(".jivo-call-error");
this.showLabel();l.handle("gui_maximize")},this)});this.actionForElements(".jivo-connected-show-chat",function(b){b.onclick=g.bind(function(b){b.preventDefault();l.gui.enableAnimation(!1);this.guiMaximize()},this)});this.actionForElements(".jivo-show-chat",function(b){b.onclick=g.bind(function(b){b.preventDefault();l.gui.enableAnimation(!1);this.guiMaximize()},this)});this.trackLogo();G.showAd()||this.addClass(".jivo-logo","jivo-hide")},trackLogo:function(){var b="https://www.ipchat.com/",c=jivo_config.locale;
if("ru_RU"===c)b="http://www.ipsite.ru/";else if("pt_PT"===c||"pt_BR"===c)b="http://www.ipchat.com.br";this.actionForElements(".jivo-logo",function(c){c.setAttribute("href",b+"?utm_source="+window.location.host+"&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad")})},clickTel:function(b){b.preventDefault();b=document.getElementById("jivo-call-tel").value.replace(/\D/g,"");10===b.toString().length?(M(this.phone,"jivo-disabled"),this.phone_number="+7"+b.toString(),this.setTimerNull(),
this.transition("FORMANIMATE")):(F(this.phone,"jivo-disabled"),this.phone.focus())},setTimerNull:function(){clearInterval(this.timer);k("cw_timer",null);this.removeClass(".jivo-timer-block","jivo-timer-show")},hideCallWidget:function(){this.hideElement(".jivo-call-form");this.actionForElements(".jivo-call-form",function(b){b.style.left=l.gui.getChatTop().getPosition().left+"px";b.style.right="auto";b.style.bottom="-350px";b.style.top="auto"});this.showElement(".jivo-call-form")},showCallWidget:function(){this.hideElement(".jivo-call-form");
this.actionForElements(".jivo-call-form",function(b){b.style.bottom="-4px";b.style.top="auto"});this.showElement(".jivo-call-form")},handlePhantomTranstion:function(b){"CLOSED"!==this.state&&"FORMVISIBLE"!==this.state&&("COLLAPSING.animate_finished"===b.action&&(this.showCallWidget(),setTimeout(function(){l.gui.widget.handle("hide")},50)),"EXPANDING.animate_finished"===b.action&&this.hideCallWidget())},showLabel:function(){l.gui.showLabelForCallWidget();l.handle("gui_minimize")},hideLabel:function(){l.handle("gui_callwidget")},
states:{CLOSED:{_onEnter:function(){this.hideElement(".jivo-call-action");this.hideCallWidget();m(l.state,l.gui.widget.state,l.gui.state);"CALLWIDGET"===l.gui.state&&this.showLabel()},cw_show_form:function(b){this.showform=b;"cw_wait"===this.currentState?this.handle("cw_wait",b):1===this.showform.show_form&&this.transition("FORMVISIBLE")},start_timer:"WAIT",cw_connecting:function(){this.currentState="cw_connecting";this.transition("CALL")},cw_connected:function(){this.currentState="cw_connected";
this.transition("CALL")},cw_wait:function(){k("cw_timer",null);this.transition("WAIT")},setPhoneNumber:function(b){this.phone.value=b.replace(/^8|^\+7|^7/,"");this.initMask();this.analyticsTitle="phoneEnter";document.getElementById("jivo-save-tel").click()}},FORMVISIBLE:{_onEnter:function(){this.hideLabel();clearInterval(this.timer);this.currentState="";this.clickClosedForm=!1;this.hideElement([".jivo-call-action",".jivo-call-error"]);this.actionForElements(".jivo-text-time",function(b){b.innerHTML=
this.seconds});this.actionForElements(".jivo-text-sec",function(b){b.innerHTML=this.secOfNum(this.seconds)});this.hideElement(".jivo-error-header");this.showElement([".jivo-form-inner",".jivo-form-header",".jivo-form-low-phone",".jivo-logo"]);1===this.formType&&this.center(this.form.find(".jivo-form-box"));this.actionForElements(".jivo-call-form",function(b){b.style.left=l.gui.getChatTop().getPosition().left+"px";b.style.right="auto";b.style.height="350px"});this.showform&&(this.showform.title&&"string"===
typeof this.showform.title?(ga("show_call_widget_invitation"),this.actionForElements(".jivo-text-center",function(b){this.analyticsTitle=b.innerHTML=this.showform.title})):ga("show_call_widget"),this.hideCallWidget(),setTimeout(g.bind(function(){this.showCallWidget()},this),50));this.actionForElements(".jivo-call-form",function(b){b.style.display="block"});this.actionForElements(".jivo-form-box",function(b){b.style.opacity="1"});this.showElement(".jivo-form-box")},cw_show_form:function(b){b.show_form&&
(this.hideLabel(),this.showCallWidget())},cw_wait:function(){this.transition("WAIT")},start_timer:"WAIT"},FORMHIDDEN:{_onEnter:function(){this.actionForElements(".jivo-call-form",function(b){b.style.bottom="-350px"});setTimeout(g.bind(function(){this.transition("CLOSED");this.showLabel()},this),200)}},FORMANIMATE:{_onEnter:function(){this.showElement(".jivo-call-action");this.actionForElements(".jivo-call-action",function(b){b.style.opacity="1"});this.handle("animatefinished")},animatefinished:function(){k("phone",
this.phone_number);this.transition("WAIT");this.showform&&this.showform.title&&"string"===typeof this.showform.title?l.handle("cw_call",{tel:this.phone_number,invitation_text:this.showform.title}):l.handle("cw_call",{tel:this.phone_number})},cw_error:function(){this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")}},WAIT:{"*":function(b){this.emit.apply(this,g.toArray(arguments))},_onEnter:function(){this.hideLabel();this.showElement(".jivo-logo");clearInterval(this.timer);
this.analyticsTitle&&B.trackCallWidgetRequested(this.analyticsTitle);this.handle("cw_wait")},cw_wait:function(){Oa(document.getElementById("jivo-timer-block"),"jivo-timer-show")||(this.removeClass(".jivo-timer-block","jivo-timer-show"),this.hideElement([".jivo-form-inner",".jivo-call-action",".jivo-call-error"]),this.showElement(".jivo-call-form"),this.actionForElements(".jivo-call-form",function(b){b.style.bottom="-4px";b.style.top="auto"}),this.hideElement(".jivo-form-header"),this.showElement("#"+
this.containerCall),this.actionForElements(".jivo-call-wait",function(b){b.style.opacity="0"}),this.hideElement([".jivo-call-step",".jivo-call-loader"]),this.showElement([".jivo-call-action",".jivo-call-wait",".jivo-call-loader",".jivo-form-low-phone"]),this.addClass(".jivo-timer-block","jivo-timer-show"),this.seconds&&this.handle("start_timer",this.seconds))},_onExit:function(){},start_timer:function(b){this.actionForElements("#"+this.containerForm,function(b){b.style.opacity="1"});b=this.seconds;
this.showElement(".jivo-call-wait");var c=1E3*b,d=document.getElementById("jivo-time");d.innerHTML=c/1E3;clearInterval(this.timer);this.timer=setInterval(g.bind(function(){if(k("cw_timer")){var b=parseInt((new Date).getTime())-parseInt(k("cw_timer"));c=1E3*this.initTimer-b;c=1E3*(c/1E3).toFixed(1);if(0>=c){clearInterval(this.timer);this.timer=!1;this.handle("timer_finished");return}}else k("cw_timer",(new Date).getTime());this.actionForElements(".jivo-call-wait",function(b){b.style.opacity="1"});
d.innerHTML=0===c/1E3%1&&Number(c)===c?c/1E3+".0":c/1E3;this.drawTimer(100-c/1E3/this.initTimer*100);c-=100;0>=c&&(d.innerHTML=c,clearInterval(this.timer),this.timer=!1,this.handle("timer_finished"))},this),100)},timer_finished:function(){this.handle("cw_connecting")},cw_connecting:function(b){this.agent_info=b;this.transition("CALL")},cw_connected:function(){this.currentState="cw_connected";this.transition("CALL")},cw_error:function(b){b&&b.reason&&(this.error_reason=b.reason);this.transition("cw_error")},
cw_call_end:function(){this.transition("cw_call_end")}},CALL:{_onEnter:function(){this.showElement("#"+this.containerCall);this.hideElement(".jivo-form-inner");this.showElement(".jivo-call-form");this.actionForElements(".jivo-call-form",function(b){b.style.bottom="-4px"});this.showElement(".jivo-logo");"CHAT"===l.gui.state?this.hideCallWidget():this.hideLabel();this.currentState?(this.handle(this.currentState),this.currentState=!1):this.handle("cw_connecting")},cw_wait:function(b){this.handle("cw_connecting",
b)},timer_finished:function(){this.timer=!1;this.handle("cw_connecting")},cw_connecting:function(b){!this.agent_info&&b&&(this.agent_info=b);this.removeClass(".jivo-call-error","jivo-error-visible");this.hideElement(".jivo-form-header");this.showAction();l.resumed_context&&l.resumed_context.agent_info&&(this.agent_info=l.resumed_context.agent_info);this.timer||(this.hideElement([".jivo-call-step",".jivo-call-end"]),this.actionForElements(".jivo-call-connected",function(b){b.setAttribute("style","")}),
this.removeClass(".jivo-call-box","jivo-operator-online"),this.hideElement(".jivo-call-online"),this.showElement([".jivo-form-low-phone",".jivo-call-connecting"]))},cw_connected:function(){clearInterval(this.timer);this.hideElement(".jivo-logo");l.resumed_context&&l.resumed_context.agent_info&&(this.agent_info=l.resumed_context.agent_info,this.actionForElements(".jivo-call-form",function(b){b.style.height="72px"}));this.agent_info&&(null!=this.agent_info.avatar_url?document.getElementById("jivo-operator-icon").setAttribute("src",
jivo_config.avatar_url+"/avatars/"+this.agent_info.avatar_url):document.getElementById("jivo-operator-icon").setAttribute("src",jivo_config.base_url+"/images/jivo-ico-operator.png"),this.agent_info.display_name&&this.actionForElements(".jivo-operator-name",function(b){b.innerHTML=this.agent_info.display_name+" <small>"+this.agent_info.title+"</small>"}));this.hideElement(".jivo-form-header .jivo-error-header .jivo-form-low-phone .jivo-call-step .jivo-call-up .jivo-call-end".split(" "));this.showAction();
this.showElement([".jivo-call-connected",".jivo-call-online"]);this.actionForElements(".jivo-call-form",function(b){b.style.height="72px"});this.handle("operator_online")},operator_online:function(){clearInterval(this.timer);this.showElement(".jivo-call-online");this.agent_info&&(0===this.agent_info.state?this.hideElement(".jivo-connected-show-chat"):this.showElement(".jivo-connected-show-chat"))},cw_error:function(){this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")},
CLOSED:function(){this.transition("CLOSED")},cw_show_form:"cw_connected"},cw_call_end:{_onEnter:function(){l.resumed_context=!1;"CHAT"!==l.gui.state&&this.hideLabel();this.setTimerNull();this.showElement(".jivo-logo");this.hideElement([".jivo-form-header",".jivo-error-header",".jivo-form-low-phone",".jivo-call-step",".jivo-call-up"]);this.showElement(".jivo-call-connected");this.removeClass(".jivo-thx-text","jivo-thx-text-show");this.removeClass(".jivo-call-box","jivo-operator-online");this.addClass(".jivo-call-box",
"jivo-operator-call-end");this.hideElement([".jivo-call-online",".jivo-call-online"]);this.showElement(".jivo-call-end");this.actionForElements(".jivo-call-form",function(b){b.style.height="350px";this.addClass(".jivo-thx-text","jivo-thx-text-show")})},start_timer:function(){this.currentState="cw_wait";this.transition("WAIT")},cw_show_form:function(){this.transition("FORMVISIBLE")},cw_wait:function(){this.transition("wait")},CLOSED:"CLOSED",_onExit:function(){this.removeClass(".jivo-thx-text","jivo-thx-text-show")}},
cw_error:{_onEnter:function(){this.hideLabel();l.resumed_context=!1;this.setTimerNull();this.hideElement("#"+this.containerCall);this.hideElement(".jivo-form-header");this.showElement([".jivo-logo",".jivo-error-header",".jivo-form-inner"]);this.actionForElements("#jivo-call-tel",function(b){b.value=this.phone.value});this.hideElement([".jivo-call-step",".jivo-call-action"]);this.error_reason?(this.actionForElements(".jivo-title-ce",function(b){b.innerHTML=r(this.error_reason)}),this.actionForElements(".jivo-err-info",
function(b){b.innerHTML=""}),delete this.error_reason):(this.actionForElements(".jivo-title-ce",function(b){b.innerHTML=r("cw_unableToConnect")}),this.actionForElements(".jivo-err-info",function(b){b.innerHTML=r("cw_errInfoText")}));setTimeout(g.bind(function(){this.addClass(".jivo-call-error","jivo-error-visible")},this),5)},cw_show_form:"FORMVISIBLE"}}}),Va={_divId:"jivo_sound_player",_playOnReady:!1,initialize:function(b){l.isMobileOrTablet()&&l.isSeparateWindow()?this.audio=document.getElementById(this._divId):
(ca||za?(this.audio=document.createElement("embed"),this.audio.setAttribute("src",z("/sounds/incoming_message.wav")),this.audio.setAttribute("autostart",!1),this.audio.setAttribute("loop",!1),this.audio.setAttribute("width",0),this.audio.setAttribute("height",0)):this.audio=document.createElement("audio"),this.audio.setAttribute("id",this._divId),b.appendChild(this.audio))},incomingMessage:function(){this._playOnReady||l.isSeparateWindow()||ca||za||(this.audio.innerHTML=X.sound_player({mp3:z("/sounds/incoming_message.mp3",
!0),ogg:z("/sounds/incoming_message.ogg",!0),wav:z("/sounds/incoming_message.wav",!0)}),this._playOnReady=!0);this.play()},pause:function(){"undefined"!==typeof this.audio.pause&&this.audio.pause()},play:function(){"undefined"!==typeof this.audio.play&&this.audio.play()}},T,da;l.isMobile()?da=setInterval(function(){(T=document.getElementById("jivo_top_wrap"))&&!l.ignore_viewport&&(T.className+="mobile-version",document.getElementById("jivo-label").style.right="auto",Ia(),clearInterval(da))},100):
l.isTablet()&&(da=setInterval(function(){if(T=document.getElementById("jivo_top_wrap"))T.className+="tablet-version",clearInterval(da)},100))})();